<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gerador de Propostas - Spdata</title>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        :root {
            --primary: #2c3e50;
            --secondary: #3498db;
            --accent: #e74c3c;
            --light: #ecf0f1;
            --dark: #2c3e50;
            --success: #27ae60;
            --warning: #f39c12;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Roboto', sans-serif;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            color: #333;
            line-height: 1.6;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        header {
            text-align: center;
            padding: 30px 0;
            background: var(--primary);
            color: white;
            border-radius: 12px 12px 0 0;
            margin-bottom: 30px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }

        header h1 {
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 10px;
        }

        header p {
            font-size: 1.1rem;
            opacity: 0.9;
        }

        .card {
            background: white;
            border-radius: 12px;
            box-shadow: 0 8px 25px rgba(0,0,0,0.08);
            padding: 30px;
            margin-bottom: 30px;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 12px 30px rgba(0,0,0,0.12);
        }

        .card h2 {
            color: var(--primary);
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid var(--secondary);
            font-size: 1.8rem;
        }

        .tabs {
            display: flex;
            margin-bottom: 20px;
            border-bottom: 2px solid #eee;
        }

        .tab {
            padding: 12px 24px;
            cursor: pointer;
            background: #f8f9fa;
            border: none;
            font-size: 1rem;
            font-weight: 500;
            color: #555;
            transition: all 0.3s;
            border-radius: 8px 8px 0 0;
            margin-right: 5px;
        }

        .tab.active {
            background: var(--secondary);
            color: white;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 25px;
            margin-bottom: 30px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: var(--dark);
        }

        select, input[type="number"], input[type="text"] {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #e1e5e9;
            border-radius: 8px;
            font-size: 1rem;
            transition: border-color 0.3s;
            background-color: #fafafa;
        }

        select:focus, input:focus {
            outline: none;
            border-color: var(--secondary);
            background-color: white;
        }

        .module-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .module-item {
            display: flex;
            align-items: center;
            background: #f8f9fa;
            padding: 12px 15px;
            border-radius: 8px;
            border: 2px solid transparent;
            cursor: pointer;
            transition: all 0.2s;
        }

        .module-item:hover {
            background: #e3f2fd;
            border-color: var(--secondary);
        }

        .module-item input[type="checkbox"] {
            margin-right: 12px;
            transform: scale(1.2);
            cursor: pointer;
        }

        .module-item label {
            margin: 0;
            cursor: pointer;
            font-weight: 500;
        }

        .special-config {
            background: #e3f2fd;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            border-left: 4px solid var(--secondary);
            display: none;
        }

        .special-config h3 {
            margin-bottom: 15px;
            color: var(--primary);
        }

        .btn {
            padding: 14px 28px;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            margin: 10px 5px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(0,0,0,0.15);
        }

        .btn:active {
            transform: translateY(0);
        }

        .btn-primary {
            background: var(--secondary);
            color: white;
        }

        .btn-success {
            background: var(--success);
            color: white;
        }

        .btn-warning {
            background: var(--warning);
            color: white;
        }

        .btn-print {
            background: #95a5a6;
            color: white;
        }

        .btn-export {
            background: #2ecc71;
            color: white;
        }

        .proposal-table {
            width: 100%;
            border-collapse: collapse;
            margin: 25px 0;
            font-size: 1rem;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
            border-radius: 8px;
            overflow: hidden;
        }

        .proposal-table th,
        .proposal-table td {
            padding: 15px;
            text-align: left;
            border-bottom: 1px solid #e0e0e0;
        }

        .proposal-table th {
            background-color: var(--primary);
            color: white;
            font-weight: 500;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .proposal-table tbody tr:nth-child(even) {
            background-color: #f8f9fa;
        }

        .proposal-table tbody tr:hover {
            background-color: #e3f2fd;
        }

        .editable {
            cursor: pointer;
            font-weight: 500;
            transition: background 0.2s;
        }

        .editable:hover {
            background: #fff9c4;
        }

        .total-section {
            background: var(--primary);
            color: white;
            padding: 25px;
            border-radius: 10px;
            margin-top: 30px;
            text-align: right;
        }

        .total-section .total-row {
            display: flex;
            justify-content: space-between;
            font-size: 1.3rem;
            margin-bottom: 10px;
            padding: 10px 0;
        }

        .total-section .total-row strong {
            font-size: 1.5rem;
        }

        .installment-section {
            background: #f1f8e9;
            padding: 20px;
            border-radius: 10px;
            margin-top: 20px;
            border: 1px solid #c5e1a5;
        }

        .installment-section h3 {
            color: #33691e;
            margin-bottom: 15px;
        }

        .action-buttons {
            text-align: center;
            margin-top: 30px;
            padding: 20px 0;
            background: #f8f9fa;
            border-radius: 10px;
        }

        .validity-notice {
            background: #fff3cd;
            padding: 15px;
            border-radius: 8px;
            border-left: 4px solid #ffc107;
            margin: 20px 0;
            font-weight: 500;
            color: #856404;
        }

        .sgh-notice {
            background: #e3f2fd;
            padding: 20px;
            border-radius: 8px;
            border-left: 4px solid #2196f3;
            margin: 20px 0;
            font-weight: 500;
            color: #0d47a1;
        }

        .history-item {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 15px;
            border-left: 4px solid var(--secondary);
            position: relative;
        }

        .history-item h4 {
            margin-bottom: 10px;
            color: var(--primary);
        }

        .history-item p {
            margin: 5px 0;
            font-size: 0.95rem;
        }

        .history-actions {
            position: absolute;
            top: 20px;
            right: 20px;
        }

        .history-actions button {
            margin-left: 5px;
            padding: 8px 12px;
            font-size: 0.9rem;
        }

        .admin-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .admin-card {
            background: #fff8e1;
            padding: 20px;
            border-radius: 8px;
            border: 1px solid #ffecb3;
        }

        .admin-card h3 {
            color: #e65100;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid #ffcc80;
        }

        .proposal-type-selector {
            display: flex;
            gap: 15px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }

        .proposal-type-btn {
            padding: 15px 25px;
            font-size: 1.1rem;
            font-weight: 500;
            border-radius: 8px;
            border: 2px solid #ddd;
            background: white;
            cursor: pointer;
            transition: all 0.3s;
        }

        .proposal-type-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }

        .proposal-type-btn.active {
            border-color: var(--secondary);
            background: var(--secondary);
            color: white;
        }

        @media print {
            body {
                background: white;
                padding: 0;
            }
            .no-print {
                display: none !important;
            }
            .card {
                box-shadow: none;
                margin: 0;
                padding: 20px;
            }
            .btn {
                display: none;
            }
        }

        @media (max-width: 768px) {
            .form-grid, .admin-grid {
                grid-template-columns: 1fr;
            }
            .module-grid {
                grid-template-columns: 1fr;
            }
            .proposal-table {
                font-size: 0.9rem;
            }
            .proposal-table th,
            .proposal-table td {
                padding: 10px 8px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>Gerador de Propostas Comerciais</h1>
            <p>Spdata - Soluções em Tecnologia para Saúde</p>
        </header>

        <!-- Tabs de Navegação -->
        <div class="card no-print">
            <div class="tabs">
                <button class="tab active" data-tab="proposal">Nova Proposta</button>
                <button class="tab" data-tab="history">Histórico de Propostas</button>
                <button class="tab" data-tab="admin">Administração de Valores</button>
            </div>

            <!-- Conteúdo da Tab: Nova Proposta -->
            <div id="proposal" class="tab-content active">
                <h2>1. Configurações da Proposta</h2>
                <div class="form-grid">
                    <div class="form-group">
                        <label for="establishment">Tipo de Estabelecimento:</label>
                        <select id="establishment">
                            <option value="">Selecione...</option>
                            <option value="filantropico">HOSP FILANTROPICO</option>
                            <option value="privado">HOSP PRIVADO</option>
                            <option value="publico">HOSP PUBLICO</option>
                            <option value="demais">DEMAIS ESTABELECIMENTOS</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="bedRange">Faixa / Categoria:</label>
                        <select id="bedRange">
                            <option value="">Selecione o tipo de estabelecimento primeiro</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="installmentCount">Parcelamento da Taxa de Implantação:</label>
                        <select id="installmentCount">
                            <option value="1">À vista (1x)</option>
                            <option value="2">2x sem juros</option>
                            <option value="3">3x sem juros</option>
                            <option value="4">4x sem juros</option>
                            <option value="5">5x sem juros</option>
                            <option value="6">6x sem juros</option>
                            <option value="7">7x sem juros</option>
                            <option value="8">8x sem juros</option>
                            <option value="9">9x sem juros</option>
                            <option value="10">10x sem juros</option>
                            <option value="11">11x sem juros</option>
                            <option value="12">12x sem juros</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="proposalName">Nome da Proposta (opcional):</label>
                        <input type="text" id="proposalName" placeholder="Ex: Proposta para Hospital São Lucas">
                    </div>
                </div>

                <!-- Seletor de Tipo de Proposta -->
                <div class="form-group">
                    <h3>Selecione o Tipo de Proposta:</h3>
                    <div class="proposal-type-selector">
                        <button class="proposal-type-btn" data-type="aberta">PROPOSTA ABERTA</button>
                        <button class="proposal-type-btn" data-type="essencial">SGH ESSENCIAL</button>
                        <button class="proposal-type-btn" data-type="todas">TODAS SOLUÇÕES</button>
                    </div>
                </div>

                <h2>2. Selecione os Módulos</h2>
                <div class="module-grid" id="modulesList">
                    <!-- Módulos serão carregados aqui -->
                </div>

                <!-- Configurações Especiais -->
                <div id="agendamentoConfig" class="special-config">
                    <h3>Configuração do Agendamento Online</h3>
                    <div class="form-grid">
                        <div class="form-group">
                            <label>Tipo de Agendamento:</label>
                            <select id="agendamentoType">
                                <option value="pacientes">Pacientes</option>
                                <option value="callcenter">Call Center</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Quantidade de Agendamentos/Mês:</label>
                            <input type="number" id="agendamentoQty" min="1" value="1000" step="1">
                        </div>
                    </div>
                </div>

                <div id="cartaoConfig" class="special-config">
                    <h3>Configuração do Cartão de Desconto</h3>
                    <div class="form-group">
                        <label>Número de Vidas:</label>
                        <input type="number" id="cartaoVidas" min="1" value="5000" step="1">
                    </div>
                </div>

                <div id="sgoConfig" class="special-config">
                    <h3>Configuração do SGO</h3>
                    <div class="form-grid">
                        <div class="form-group">
                            <label>Número de Beneficiários:</label>
                            <input type="number" id="sgoBeneficiarios" min="1" value="2500" step="1">
                        </div>
                        <div class="form-group">
                            <label>Incluir Beneficiário Mobile? (R$ 500,00)</label>
                            <select id="sgoMobile">
                                <option value="nao">Não</option>
                                <option value="sim">Sim</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Incluir Portal Autorizador Online? (R$ 500,00)</label>
                            <select id="sgoPortal">
                                <option value="nao">Não</option>
                                <option value="sim">Sim</option>
                            </select>
                        </div>
                    </div>
                </div>

                <div id="smsConfig" class="special-config">
                    <h3>Configuração de SMS</h3>
                    <div class="form-group">
                        <label>Selecione o Pacote de SMS:</label>
                        <select id="smsPacote">
                            <option value="1000">1.000 SMS - R$ 180,00</option>
                            <option value="5000">5.000 SMS - R$ 720,00</option>
                            <option value="10000">10.000 SMS - R$ 1.200,00</option>
                        </select>
                    </div>
                </div>

                <div class="action-buttons">
                    <button class="btn btn-primary" onclick="generateProposal()">
                        🔄 Gerar Proposta
                    </button>
                    <button class="btn btn-warning" onclick="saveCurrentProposal()">
                        💾 Salvar Proposta
                    </button>
                </div>
            </div>

            <!-- Conteúdo da Tab: Histórico -->
            <div id="history" class="tab-content">
                <h2>Histórico de Propostas Salvas</h2>
                <p>Propostas são salvas localmente neste navegador.</p>
                <div id="historyList">
                    <!-- Propostas salvas aparecerão aqui -->
                    <p style="text-align: center; padding: 40px; color: #777;">Nenhuma proposta salva ainda.</p>
                </div>
            </div>

            <!-- Conteúdo da Tab: Administração -->
            <div id="admin" class="tab-content">
                <h2>Administração de Valores</h2>
                <p>Edite os valores dos módulos. Alterações são salvas localmente neste navegador.</p>
                
                <div class="admin-grid">
                    <div class="admin-card">
                        <h3>Valores Mensais por Módulo</h3>
                        <div class="form-group">
                            <label for="adminModuleSelect">Selecione um Módulo:</label>
                            <select id="adminModuleSelect" style="width: 100%; padding: 10px;">
                                <option value="">-- Selecione --</option>
                            </select>
                        </div>
                        <div id="adminValueInputs" style="margin-top: 20px;">
                            <!-- Inputs gerados dinamicamente -->
                        </div>
                        <button class="btn btn-success" onclick="saveAdminChanges()" style="margin-top: 20px;">
                            💾 Salvar Alterações
                        </button>
                    </div>

                    <div class="admin-card">
                        <h3>Valores de Implantação por Módulo</h3>
                        <div class="form-group">
                            <label for="adminImplantModuleSelect">Selecione um Módulo:</label>
                            <select id="adminImplantModuleSelect" style="width: 100%; padding: 10px;">
                                <option value="">-- Selecione --</option>
                            </select>
                        </div>
                        <div id="adminImplantValueInputs" style="margin-top: 20px;">
                            <!-- Inputs gerados dinamicamente -->
                        </div>
                        <button class="btn btn-success" onclick="saveImplantAdminChanges()" style="margin-top: 20px;">
                            💾 Salvar Alterações de Implantação
                        </button>
                    </div>

                    <div class="admin-card">
                        <h3>Módulos Especiais</h3>
                        <div class="form-group">
                            <label for="adminSpecialModuleSelect">Selecione um Módulo Especial:</label>
                            <select id="adminSpecialModuleSelect" style="width: 100%; padding: 10px;">
                                <option value="">-- Selecione --</option>
                                <option value="Agendamento Online">Agendamento Online</option>
                                <option value="CARTÃO DE DESCONTO">CARTÃO DE DESCONTO</option>
                                <option value="SGO">SGO</option>
                                <option value="SMS">SMS</option>
                            </select>
                        </div>
                        <div id="adminSpecialValueInputs" style="margin-top: 20px;">
                            <!-- Inputs gerados dinamicamente -->
                        </div>
                        <button class="btn btn-success" onclick="saveSpecialAdminChanges()" style="margin-top: 20px;">
                            💾 Salvar Alterações Especiais
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Proposta Gerada -->
        <div class="card" id="proposalResult" style="display: none;">
            <h2>3. Sua Proposta Comercial</h2>

            <div class="validity-notice">
                ⚠️ <strong>Esta proposta tem validade de 30 dias</strong> a partir da data de emissão.
            </div>

            <!-- Observação Especial para SGH ESSENCIAL -->
            <div id="sghEssencialNotice" class="sgh-notice" style="display: none;">
                💡 <strong>Pacote SGH ESSENCIAL</strong><br>
                - Valor fixo mensal: <strong>R$5.800,00</strong> (inclui mensalidade e taxa de implantação).<br>
                - Contrato de 36 meses com redução de 25% após este período.<br>
                - <strong>Despesas durante implantação (como deslocamento, hospedagem, alimentação) são de responsabilidade do cliente.</strong>
            </div>

            <table class="proposal-table">
                <thead>
                    <tr>
                        <th>Módulo</th>
                        <th>Valor Mensal</th>
                        <th>Valor Implantação</th>
                    </tr>
                </thead>
                <tbody id="proposalTableBody">
                    <!-- Itens da proposta -->
                </tbody>
            </table>

            <div class="total-section">
                <div class="total-row">
                    <span>Valor Total Mensal:</span>
                    <strong id="totalMensal">R$0,00</strong>
                </div>
                <div class="total-row">
                    <span>Valor Total de Implantação:</span>
                    <strong id="totalImplantacao">R$0,00</strong>
                </div>
                <div class="total-row" style="font-size: 1.8rem; margin-top: 20px; border-top: 2px solid rgba(255,255,255,0.3); padding-top: 20px;">
                    <span>Valor Total da Proposta (à vista):</span>
                    <strong id="totalGeral">R$0,00</strong>
                </div>
            </div>

            <div class="installment-section">
                <h3>Parcelamento da Taxa de Implantação</h3>
                <div class="total-row">
                    <span>Valor por Parcela (sem juros):</span>
                    <strong id="parcelaValor">R$0,00</strong>
                </div>
                <div class="total-row">
                    <span>Total em Parcelas:</span>
                    <strong id="parcelaTotal">R$0,00</strong>
                </div>
                <div class="total-row">
                    <span>Forma de Pagamento:</span>
                    <strong id="formaPagamento">-</strong>
                </div>
            </div>

            <div class="action-buttons no-print">
                <button class="btn btn-export" onclick="exportToExcel()">
                    📊 Exportar para Excel
                </button>
                <button class="btn btn-print" onclick="window.print()">
                    🖨️ Imprimir Proposta
                </button>
                <button class="btn btn-warning" onclick="saveCurrentProposal()">
                    💾 Salvar esta Proposta
                </button>
            </div>
        </div>
    </div>

    <script>
        // Dados de precificação baseados na planilha fornecida
        let pricingData = {
            "filantropico": {
                "1 a 50 leitos": {
                    "Faturamento de AIH": 480.00,
                    "Faturamento de Ambulatório": 240.00,
                    "Faturamento de Convênios": 360.00,
                    "Controle de Estoque": 420.00,
                    "Recepção Interna": 240.00,
                    "Recepção Externa": 240.00,
                    "SADT - Radiologia": 180.00,
                    "SADT - Laboratório": 420.00,
                    "SADT - Endoscopia": 180.00,
                    "SADT - Anatomia Patológica": 120.00,
                    "SADT - Ultra-Sonografia": 180.00,
                    "Bloco Cirúrgico": 240.00,
                    "SADT - Tomografia": 180.00,
                    "Contabilidade": 420.00,
                    "Financeiro": 480.00,
                    "APAC": 240.00,
                    "Custos": 360.00,
                    "SADT - Hemodinâmica": 180.00,
                    "Folha de Pagamento": 1600.00,
                    "Patrimônio": 180.00,
                    "SIG - Sistema de Informações Gerenciais": 0,
                    "SADT- Outros": 180.00,
                    "Orçamento": 120.00,
                    "SADT- Ressonância Magnética": 180.00,
                    "SGHIntelligence": 720.00,
                    "Agendamento (normal)": 180.00,
                    "Agendamento de Quimmioterapia": 240.00,
                    "Agendamento de Plantão": 180.00,
                    "SADT- Hemoterapia": 180.00,
                    "Painel Eletrônico*": 180.00,
                    "PACs (apenas Worklist)": 180.00,
                    "SPED": 120.00,
                    "Gestão de Repasse e Terceiros": 300.00,
                    "SAC *": 60.00,
                    "Controle de Acessos": 180.00,
                    "Higienização de Leitos *": 120.00,
                    "DMED": 120.00,
                    "Web Service DICOM": 120.00,
                    "Integrador Laboratório Web Service": 120.00,
                    "Integrador Laboratório WebService Padrão SPDATA": 120.00,
                    "PEP - Prontuário Eletrônico do Paciente": 120.00,
                    "Nota Fiscal Eletrônica": 120.00,
                    "Portal de Serviços": 180.00,
                    "Laudo Web": 120.00,
                    "SGHQuali": 720.00,
                    "Portal de Compras": 480.00,
                    "Chamada Digital": 180.00,
                    "EFD REINF": 240.00,
                    "SPD STORAGE": 0,
                    "E-Social": 0,
                    "Aplicação Web Custos": 240.00,
                    "CEMEX": 950.00,
                    "Interação API (Laudos)": 180.00,
                    "SGH Intelligence Web": 0,
                    "SGH Intelligence Custos": 240.00,
                    "Painel Estatístico_Gestão a Vista (Web/CS)": 180.00,
                    "Gerador de Relatorios": 0,
                    "Central de reservas de Leitos": 180.00
                },
                "51 a 100": {
                    "Faturamento de AIH": 540.00,
                    "Faturamento de Ambulatório": 360.00,
                    "Faturamento de Convênios": 540.00,
                    "Controle de Estoque": 600.00,
                    "Recepção Interna": 360.00,
                    "Recepção Externa": 360.00,
                    "SADT - Radiologia": 240.00,
                    "SADT - Laboratório": 480.00,
                    "SADT - Endoscopia": 240.00,
                    "SADT - Anatomia Patológica": 180.00,
                    "SADT - Ultra-Sonografia": 240.00,
                    "Bloco Cirúrgico": 360.00,
                    "SADT - Tomografia": 240.00,
                    "Contabilidade": 540.00,
                    "Financeiro": 600.00,
                    "APAC": 360.00,
                    "Custos": 600.00,
                    "SADT - Hemodinâmica": 240.00,
                    "Folha de Pagamento": 1600.00,
                    "Patrimônio": 240.00,
                    "SIG - Sistema de Informações Gerenciais": 0,
                    "SADT- Outros": 240.00,
                    "Orçamento": 180.00,
                    "SADT- Ressonância Magnética": 240.00,
                    "SGHIntelligence": 960.00,
                    "Agendamento (normal)": 180.00,
                    "Agendamento de Quimmioterapia": 240.00,
                    "Agendamento de Plantão": 180.00,
                    "SADT- Hemoterapia": 240.00,
                    "Painel Eletrônico*": 240.00,
                    "PACs (apenas Worklist)": 180.00,
                    "SPED": 120.00,
                    "Gestão de Repasse e Terceiros": 360.00,
                    "SAC *": 120.00,
                    "Controle de Acessos": 300.00,
                    "Higienização de Leitos *": 180.00,
                    "DMED": 120.00,
                    "Web Service DICOM": 180.00,
                    "Integrador Laboratório Web Service": 180.00,
                    "Integrador Laboratório WebService Padrão SPDATA": 180.00,
                    "PEP - Prontuário Eletrônico do Paciente": 180.00,
                    "Nota Fiscal Eletrônica": 180.00,
                    "Portal de Serviços": 240.00,
                    "Laudo Web": 180.00,
                    "SGHQuali": 960.00,
                    "Portal de Compras": 660.00,
                    "Chamada Digital": 180.00,
                    "EFD REINF": 360.00,
                    "SPD STORAGE": 0,
                    "E-Social": 0,
                    "Aplicação Web Custos": 240.00,
                    "CEMEX": 1230.00,
                    "Interação API (Laudos)": 180.00,
                    "SGH Intelligence Web": 0,
                    "SGH Intelligence Custos": 240.00,
                    "Painel Estatístico_Gestão a Vista (Web/CS)": 240.00,
                    "Gerador de Relatorios": 0,
                    "Central de reservas de Leitos": 240.00
                },
                "101 a 200": {
                    "Faturamento de AIH": 720.00,
                    "Faturamento de Ambulatório": 480.00,
                    "Faturamento de Convênios": 720.00,
                    "Controle de Estoque": 840.00,
                    "Recepção Interna": 480.00,
                    "Recepção Externa": 480.00,
                    "SADT - Radiologia": 300.00,
                    "SADT - Laboratório": 540.00,
                    "SADT - Endoscopia": 300.00,
                    "SADT - Anatomia Patológica": 216.00,
                    "SADT - Ultra-Sonografia": 300.00,
                    "Bloco Cirúrgico": 480.00,
                    "SADT - Tomografia": 300.00,
                    "Contabilidade": 660.00,
                    "Financeiro": 720.00,
                    "APAC": 480.00,
                    "Custos": 720.00,
                    "SADT - Hemodinâmica": 300.00,
                    "Folha de Pagamento": 1600.00,
                    "Patrimônio": 300.00,
                    "SIG - Sistema de Informações Gerenciais": 0,
                    "SADT- Outros": 300.00,
                    "Orçamento": 240.00,
                    "SADT- Ressonância Magnética": 300.00,
                    "SGHIntelligence": 1200.00,
                    "Agendamento (normal)": 180.00,
                    "Agendamento de Quimmioterapia": 240.00,
                    "Agendamento de Plantão": 180.00,
                    "SADT- Hemoterapia": 300.00,
                    "Painel Eletrônico*": 360.00,
                    "PACs (apenas Worklist)": 180.00,
                    "SPED": 120.00,
                    "Gestão de Repasse e Terceiros": 480.00,
                    "SAC *": 180.00,
                    "Controle de Acessos": 360.00,
                    "Higienização de Leitos *": 240.00,
                    "DMED": 120.00,
                    "Web Service DICOM": 240.00,
                    "Integrador Laboratório Web Service": 240.00,
                    "Integrador Laboratório WebService Padrão SPDATA": 240.00,
                    "PEP - Prontuário Eletrônico do Paciente": 240.00,
                    "Nota Fiscal Eletrônica": 240.00,
                    "Portal de Serviços": 360.00,
                    "Laudo Web": 240.00,
                    "SGHQuali": 1200.00,
                    "Portal de Compras": 840.00,
                    "Chamada Digital": 180.00,
                    "EFD REINF": 480.00,
                    "SPD STORAGE": 0,
                    "E-Social": 0,
                    "Aplicação Web Custos": 300.00,
                    "CEMEX": 1650.00,
                    "Interação API (Laudos)": 180.00,
                    "SGH Intelligence Web": 0,
                    "SGH Intelligence Custos": 300.00,
                    "Painel Estatístico_Gestão a Vista (Web/CS)": 360.00,
                    "Gerador de Relatorios": 0,
                    "Central de reservas de Leitos": 300.00
                },
                "Acima de 200": {
                    "Faturamento de AIH": 1080.00,
                    "Faturamento de Ambulatório": 840.00,
                    "Faturamento de Convênios": 1200.00,
                    "Controle de Estoque": 1200.00,
                    "Recepção Interna": 780.00,
                    "Recepção Externa": 780.00,
                    "SADT - Radiologia": 480.00,
                    "SADT - Laboratório": 600.00,
                    "SADT - Endoscopia": 480.00,
                    "SADT - Anatomia Patológica": 480.00,
                    "SADT - Ultra-Sonografia": 480.00,
                    "Bloco Cirúrgico": 780.00,
                    "SADT - Tomografia": 480.00,
                    "Contabilidade": 900.00,
                    "Financeiro": 840.00,
                    "APAC": 840.00,
                    "Custos": 840.00,
                    "SADT - Hemodinâmica": 480.00,
                    "Folha de Pagamento": 1600.00,
                    "Patrimônio": 420.00,
                    "SIG - Sistema de Informações Gerenciais": 0,
                    "SADT- Outros": 480.00,
                    "Orçamento": 300.00,
                    "SADT- Ressonância Magnética": 480.00,
                    "SGHIntelligence": 1800.00,
                    "Agendamento (normal)": 180.00,
                    "Agendamento de Quimmioterapia": 240.00,
                    "Agendamento de Plantão": 180.00,
                    "SADT- Hemoterapia": 480.00,
                    "Painel Eletrônico*": 600.00,
                    "PACs (apenas Worklist)": 180.00,
                    "SPED": 120.00,
                    "Gestão de Repasse e Terceiros": 600.00,
                    "SAC *": 300.00,
                    "Controle de Acessos": 420.00,
                    "Higienização de Leitos *": 360.00,
                    "DMED": 120.00,
                    "Web Service DICOM": 300.00,
                    "Integrador Laboratório Web Service": 300.00,
                    "Integrador Laboratório WebService Padrão SPDATA": 300.00,
                    "PEP - Prontuário Eletrônico do Paciente": 300.00,
                    "Nota Fiscal Eletrônica": 300.00,
                    "Portal de Serviços": 420.00,
                    "Laudo Web": 300.00,
                    "SGHQuali": 1800.00,
                    "Portal de Compras": 960.00,
                    "Chamada Digital": 180.00,
                    "EFD REINF": 600.00,
                    "SPD STORAGE": 0,
                    "E-Social": 0,
                    "Aplicação Web Custos": 300.00,
                    "CEMEX": 2170.00,
                    "Interação API (Laudos)": 180.00,
                    "SGH Intelligence Web": 0,
                    "SGH Intelligence Custos": 300.00,
                    "Painel Estatístico_Gestão a Vista (Web/CS)": 600.00,
                    "Gerador de Relatorios": 0,
                    "Central de reservas de Leitos": 360.00
                }
            },
            "privado": {
                "1 a 50 leitos": {
                    "Faturamento de AIH": 0,
                    "Faturamento de Ambulatório": 0,
                    "Faturamento de Convênios": 720.00,
                    "Controle de Estoque": 480.00,
                    "Recepção Interna": 240.00,
                    "Recepção Externa": 240.00,
                    "SADT - Radiologia": 180.00,
                    "SADT - Laboratório": 420.00,
                    "SADT - Endoscopia": 180.00,
                    "SADT - Anatomia Patológica": 180.00,
                    "SADT - Ultra-Sonografia": 180.00,
                    "Bloco Cirúrgico": 240.00,
                    "SADT - Tomografia": 180.00,
                    "Contabilidade": 420.00,
                    "Financeiro": 480.00,
                    "APAC": 0,
                    "Custos": 360.00,
                    "SADT - Hemodinâmica": 180.00,
                    "Folha de Pagamento": 1600.00,
                    "Patrimônio": 180.00,
                    "SIG - Sistema de Informações Gerenciais": 0,
                    "SADT- Outros": 180.00,
                    "Orçamento": 120.00,
                    "SADT- Ressonância Magnética": 180.00,
                    "SGHIntelligence": 720.00,
                    "Agendamento (normal)": 180.00,
                    "Agendamento de Quimmioterapia": 240.00,
                    "Agendamento de Plantão": 180.00,
                    "SADT- Hemoterapia": 180.00,
                    "Painel Eletrônico*": 180.00,
                    "PACs (apenas Worklist)": 180.00,
                    "SPED": 120.00,
                    "Gestão de Repasse e Terceiros": 300.00,
                    "SAC *": 60.00,
                    "Controle de Acessos": 180.00,
                    "Higienização de Leitos *": 120.00,
                    "DMED": 120.00,
                    "Web Service DICOM": 120.00,
                    "Integrador Laboratório Web Service": 120.00,
                    "Integrador Laboratório WebService Padrão SPDATA": 120.00,
                    "PEP - Prontuário Eletrônico do Paciente": 120.00,
                    "Nota Fiscal Eletrônica": 180.00,
                    "Portal de Serviços": 180.00,
                    "Laudo Web": 120.00,
                    "SGHQuali": 720.00,
                    "Portal de Compras": 480.00,
                    "Chamada Digital": 180.00,
                    "EFD REINF": 180.00,
                    "SPD STORAGE": 0,
                    "E-Social": 0,
                    "Aplicação Web Custos": 240.00,
                    "CEMEX": 950.00,
                    "Interação API (Laudos)": 180.00,
                    "SGH Intelligence Web": 0,
                    "SGH Intelligence Custos": 240.00,
                    "Painel Estatístico_Gestão a Vista (Web/CS)": 180.00,
                    "Gerador de Relatorios": 0,
                    "Central de reservas de Leitos": 180.00
                },
                "51 a 100": {
                    "Faturamento de AIH": 0,
                    "Faturamento de Ambulatório": 0,
                    "Faturamento de Convênios": 960.00,
                    "Controle de Estoque": 660.00,
                    "Recepção Interna": 360.00,
                    "Recepção Externa": 360.00,
                    "SADT - Radiologia": 276.00,
                    "SADT - Laboratório": 480.00,
                    "SADT - Endoscopia": 276.00,
                    "SADT - Anatomia Patológica": 276.00,
                    "SADT - Ultra-Sonografia": 276.00,
                    "Bloco Cirúrgico": 360.00,
                    "SADT - Tomografia": 276.00,
                    "Contabilidade": 540.00,
                    "Financeiro": 600.00,
                    "APAC": 0,
                    "Custos": 480.00,
                    "SADT - Hemodinâmica": 276.00,
                    "Folha de Pagamento": 1600.00,
                    "Patrimônio": 240.00,
                    "SIG - Sistema de Informações Gerenciais": 0,
                    "SADT- Outros": 276.00,
                    "Orçamento": 180.00,
                    "SADT- Ressonância Magnética": 276.00,
                    "SGHIntelligence": 960.00,
                    "Agendamento (normal)": 180.00,
                    "Agendamento de Quimmioterapia": 240.00,
                    "Agendamento de Plantão": 180.00,
                    "SADT- Hemoterapia": 276.00,
                    "Painel Eletrônico*": 240.00,
                    "PACs (apenas Worklist)": 180.00,
                    "SPED": 120.00,
                    "Gestão de Repasse e Terceiros": 360.00,
                    "SAC *": 120.00,
                    "Controle de Acessos": 300.00,
                    "Higienização de Leitos *": 180.00,
                    "DMED": 120.00,
                    "Web Service DICOM": 180.00,
                    "Integrador Laboratório Web Service": 180.00,
                    "Integrador Laboratório WebService Padrão SPDATA": 180.00,
                    "PEP - Prontuário Eletrônico do Paciente": 180.00,
                    "Nota Fiscal Eletrônica": 240.00,
                    "Portal de Serviços": 240.00,
                    "Laudo Web": 180.00,
                    "SGHQuali": 960.00,
                    "Portal de Compras": 660.00,
                    "Chamada Digital": 180.00,
                    "EFD REINF": 240.00,
                    "SPD STORAGE": 0,
                    "E-Social": 0,
                    "Aplicação Web Custos": 240.00,
                    "CEMEX": 1230.00,
                    "Interação API (Laudos)": 180.00,
                    "SGH Intelligence Web": 0,
                    "SGH Intelligence Custos": 240.00,
                    "Painel Estatístico_Gestão a Vista (Web/CS)": 240.00,
                    "Gerador de Relatorios": 0,
                    "Central de reservas de Leitos": 240.00
                },
                "101 a 200": {
                    "Faturamento de AIH": 0,
                    "Faturamento de Ambulatório": 0,
                    "Faturamento de Convênios": 1440.00,
                    "Controle de Estoque": 840.00,
                    "Recepção Interna": 480.00,
                    "Recepção Externa": 480.00,
                    "SADT - Radiologia": 336.00,
                    "SADT - Laboratório": 540.00,
                    "SADT - Endoscopia": 336.00,
                    "SADT - Anatomia Patológica": 336.00,
                    "SADT - Ultra-Sonografia": 336.00,
                    "Bloco Cirúrgico": 480.00,
                    "SADT - Tomografia": 336.00,
                    "Contabilidade": 660.00,
                    "Financeiro": 720.00,
                    "APAC": 0,
                    "Custos": 600.00,
                    "SADT - Hemodinâmica": 336.00,
                    "Folha de Pagamento": 1600.00,
                    "Patrimônio": 300.00,
                    "SIG - Sistema de Informações Gerenciais": 0,
                    "SADT- Outros": 336.00,
                    "Orçamento": 240.00,
                    "SADT- Ressonância Magnética": 336.00,
                    "SGHIntelligence": 1200.00,
                    "Agendamento (normal)": 180.00,
                    "Agendamento de Quimmioterapia": 240.00,
                    "Agendamento de Plantão": 180.00,
                    "SADT- Hemoterapia": 336.00,
                    "Painel Eletrônico*": 360.00,
                    "PACs (apenas Worklist)": 180.00,
                    "SPED": 120.00,
                    "Gestão de Repasse e Terceiros": 480.00,
                    "SAC *": 180.00,
                    "Controle de Acessos": 360.00,
                    "Higienização de Leitos *": 240.00,
                    "DMED": 120.00,
                    "Web Service DICOM": 240.00,
                    "Integrador Laboratório Web Service": 240.00,
                    "Integrador Laboratório WebService Padrão SPDATA": 240.00,
                    "PEP - Prontuário Eletrônico do Paciente": 240.00,
                    "Nota Fiscal Eletrônica": 300.00,
                    "Portal de Serviços": 360.00,
                    "Laudo Web": 240.00,
                    "SGHQuali": 1200.00,
                    "Portal de Compras": 840.00,
                    "Chamada Digital": 180.00,
                    "EFD REINF": 360.00,
                    "SPD STORAGE": 0,
                    "E-Social": 0,
                    "Aplicação Web Custos": 300.00,
                    "CEMEX": 1650.00,
                    "Interação API (Laudos)": 180.00,
                    "SGH Intelligence Web": 0,
                    "SGH Intelligence Custos": 300.00,
                    "Painel Estatístico_Gestão a Vista (Web/CS)": 360.00,
                    "Gerador de Relatorios": 0,
                    "Central de reservas de Leitos": 300.00
                },
                "Acima de 200": {
                    "Faturamento de AIH": 0,
                    "Faturamento de Ambulatório": 0,
                    "Faturamento de Convênios": 1920.00,
                    "Controle de Estoque": 1200.00,
                    "Recepção Interna": 780.00,
                    "Recepção Externa": 780.00,
                    "SADT - Radiologia": 480.00,
                    "SADT - Laboratório": 600.00,
                    "SADT - Endoscopia": 480.00,
                    "SADT - Anatomia Patológica": 480.00,
                    "SADT - Ultra-Sonografia": 480.00,
                    "Bloco Cirúrgico": 780.00,
                    "SADT - Tomografia": 480.00,
                    "Contabilidade": 900.00,
                    "Financeiro": 840.00,
                    "APAC": 0,
                    "Custos": 840.00,
                    "SADT - Hemodinâmica": 480.00,
                    "Folha de Pagamento": 1600.00,
                    "Patrimônio": 420.00,
                    "SIG - Sistema de Informações Gerenciais": 0,
                    "SADT- Outros": 480.00,
                    "Orçamento": 300.00,
                    "SADT- Ressonância Magnética": 480.00,
                    "SGHIntelligence": 1800.00,
                    "Agendamento (normal)": 180.00,
                    "Agendamento de Quimmioterapia": 240.00,
                    "Agendamento de Plantão": 180.00,
                    "SADT- Hemoterapia": 480.00,
                    "Painel Eletrônico*": 600.00,
                    "PACs (apenas Worklist)": 180.00,
                    "SPED": 120.00,
                    "Gestão de Repasse e Terceiros": 600.00,
                    "SAC *": 300.00,
                    "Controle de Acessos": 420.00,
                    "Higienização de Leitos *": 360.00,
                    "DMED": 120.00,
                    "Web Service DICOM": 300.00,
                    "Integrador Laboratório Web Service": 300.00,
                    "Integrador Laboratório WebService Padrão SPDATA": 300.00,
                    "PEP - Prontuário Eletrônico do Paciente": 300.00,
                    "Nota Fiscal Eletrônica": 360.00,
                    "Portal de Serviços": 420.00,
                    "Laudo Web": 300.00,
                    "SGHQuali": 1800.00,
                    "Portal de Compras": 960.00,
                    "Chamada Digital": 180.00,
                    "EFD REINF": 600.00,
                    "SPD STORAGE": 0,
                    "E-Social": 0,
                    "Aplicação Web Custos": 300.00,
                    "CEMEX": 2170.00,
                    "Interação API (Laudos)": 180.00,
                    "SGH Intelligence Web": 0,
                    "SGH Intelligence Custos": 300.00,
                    "Painel Estatístico_Gestão a Vista (Web/CS)": 600.00,
                    "Gerador de Relatorios": 0,
                    "Central de reservas de Leitos": 360.00
                }
            },
            "publico": {
                "1 a 50 leitos": {
                    "Faturamento de AIH": 720.00,
                    "Faturamento de Ambulatório": 480.00,
                    "Faturamento de Convênios": 0,
                    "Controle de Estoque": 480.00,
                    "Recepção Interna": 240.00,
                    "Recepção Externa": 240.00,
                    "SADT - Radiologia": 240.00,
                    "SADT - Laboratório": 480.00,
                    "SADT - Endoscopia": 240.00,
                    "SADT - Anatomia Patológica": 240.00,
                    "SADT - Ultra-Sonografia": 240.00,
                    "Bloco Cirúrgico": 240.00,
                    "SADT - Tomografia": 240.00,
                    "Contabilidade": 420.00,
                    "Financeiro": 480.00,
                    "APAC": 480.00,
                    "Custos": 480.00,
                    "SADT - Hemodinâmica": 240.00,
                    "Folha de Pagamento": 1600.00,
                    "Patrimônio": 360.00,
                    "SIG - Sistema de Informações Gerenciais": 0,
                    "SADT- Outros": 240.00,
                    "Orçamento": 240.00,
                    "SADT- Ressonância Magnética": 240.00,
                    "SGHIntelligence": 720.00,
                    "Agendamento (normal)": 180.00,
                    "Agendamento de Quimmioterapia": 240.00,
                    "Agendamento de Plantão": 180.00,
                    "SADT- Hemoterapia": 240.00,
                    "Painel Eletrônico*": 240.00,
                    "PACs (apenas Worklist)": 180.00,
                    "SPED": 120.00,
                    "Gestão de Repasse e Terceiros": 300.00,
                    "SAC *": 60.00,
                    "Controle de Acessos": 180.00,
                    "Higienização de Leitos *": 120.00,
                    "DMED": 120.00,
                    "Web Service DICOM": 180.00,
                    "Integrador Laboratório Web Service": 180.00,
                    "Integrador Laboratório WebService Padrão SPDATA": 180.00,
                    "PEP - Prontuário Eletrônico do Paciente": 120.00,
                    "Nota Fiscal Eletrônica": 0,
                    "Portal de Serviços": 240.00,
                    "Laudo Web": 120.00,
                    "SGHQuali": 720.00,
                    "Portal de Compras": 480.00,
                    "Chamada Digital": 180.00,
                    "EFD REINF": 180.00,
                    "SPD STORAGE": 0,
                    "E-Social": 0,
                    "Aplicação Web Custos": 240.00,
                    "CEMEX": "ñ participa",
                    "Interação API (Laudos)": 180.00,
                    "SGH Intelligence Web": 0,
                    "SGH Intelligence Custos": 240.00,
                    "Painel Estatístico_Gestão a Vista (Web/CS)": 180.00,
                    "Gerador de Relatorios": 0,
                    "Central de reservas de Leitos": 180.00
                },
                "51 a 100": {
                    "Faturamento de AIH": 960.00,
                    "Faturamento de Ambulatório": 720.00,
                    "Faturamento de Convênios": 0,
                    "Controle de Estoque": 660.00,
                    "Recepção Interna": 360.00,
                    "Recepção Externa": 360.00,
                    "SADT - Radiologia": 300.00,
                    "SADT - Laboratório": 540.00,
                    "SADT - Endoscopia": 300.00,
                    "SADT - Anatomia Patológica": 300.00,
                    "SADT - Ultra-Sonografia": 300.00,
                    "Bloco Cirúrgico": 360.00,
                    "SADT - Tomografia": 300.00,
                    "Contabilidade": 540.00,
                    "Financeiro": 600.00,
                    "APAC": 720.00,
                    "Custos": 720.00,
                    "SADT - Hemodinâmica": 300.00,
                    "Folha de Pagamento": 1600.00,
                    "Patrimônio": 480.00,
                    "SIG - Sistema de Informações Gerenciais": 0,
                    "SADT- Outros": 300.00,
                    "Orçamento": 360.00,
                    "SADT- Ressonância Magnética": 300.00,
                    "SGHIntelligence": 960.00,
                    "Agendamento (normal)": 180.00,
                    "Agendamento de Quimmioterapia": 240.00,
                    "Agendamento de Plantão": 180.00,
                    "SADT- Hemoterapia": 300.00,
                    "Painel Eletrônico*": 300.00,
                    "PACs (apenas Worklist)": 180.00,
                    "SPED": 120.00,
                    "Gestão de Repasse e Terceiros": 360.00,
                    "SAC *": 120.00,
                    "Controle de Acessos": 300.00,
                    "Higienização de Leitos *": 180.00,
                    "DMED": 120.00,
                    "Web Service DICOM": 240.00,
                    "Integrador Laboratório Web Service": 240.00,
                    "Integrador Laboratório WebService Padrão SPDATA": 240.00,
                    "PEP - Prontuário Eletrônico do Paciente": 180.00,
                    "Nota Fiscal Eletrônica": 0,
                    "Portal de Serviços": 300.00,
                    "Laudo Web": 180.00,
                    "SGHQuali": 960.00,
                    "Portal de Compras": 660.00,
                    "Chamada Digital": 180.00,
                    "EFD REINF": 240.00,
                    "SPD STORAGE": 0,
                    "E-Social": 0,
                    "Aplicação Web Custos": 240.00,
                    "CEMEX": "ñ participa",
                    "Interação API (Laudos)": 180.00,
                    "SGH Intelligence Web": 0,
                    "SGH Intelligence Custos": 240.00,
                    "Painel Estatístico_Gestão a Vista (Web/CS)": 240.00,
                    "Gerador de Relatorios": 0,
                    "Central de reservas de Leitos": 240.00
                },
                "101 a 200": {
                    "Faturamento de AIH": 1440.00,
                    "Faturamento de Ambulatório": 1080.00,
                    "Faturamento de Convênios": 0,
                    "Controle de Estoque": 840.00,
                    "Recepção Interna": 480.00,
                    "Recepção Externa": 480.00,
                    "SADT - Radiologia": 360.00,
                    "SADT - Laboratório": 600.00,
                    "SADT - Endoscopia": 360.00,
                    "SADT - Anatomia Patológica": 360.00,
                    "SADT - Ultra-Sonografia": 360.00,
                    "Bloco Cirúrgico": 480.00,
                    "SADT - Tomografia": 360.00,
                    "Contabilidade": 660.00,
                    "Financeiro": 720.00,
                    "APAC": 1080.00,
                    "Custos": 960.00,
                    "SADT - Hemodinâmica": 360.00,
                    "Folha de Pagamento": 1600.00,
                    "Patrimônio": 600.00,
                    "SIG - Sistema de Informações Gerenciais": 0,
                    "SADT- Outros": 360.00,
                    "Orçamento": 480.00,
                    "SADT- Ressonância Magnética": 360.00,
                    "SGHIntelligence": 1200.00,
                    "Agendamento (normal)": 180.00,
                    "Agendamento de Quimmioterapia": 240.00,
                    "Agendamento de Plantão": 180.00,
                    "SADT- Hemoterapia": 360.00,
                    "Painel Eletrônico*": 420.00,
                    "PACs (apenas Worklist)": 180.00,
                    "SPED": 120.00,
                    "Gestão de Repasse e Terceiros": 480.00,
                    "SAC *": 180.00,
                    "Controle de Acessos": 360.00,
                    "Higienização de Leitos *": 240.00,
                    "DMED": 120.00,
                    "Web Service DICOM": 300.00,
                    "Integrador Laboratório Web Service": 300.00,
                    "Integrador Laboratório WebService Padrão SPDATA": 300.00,
                    "PEP - Prontuário Eletrônico do Paciente": 240.00,
                    "Nota Fiscal Eletrônica": 0,
                    "Portal de Serviços": 420.00,
                    "Laudo Web": 240.00,
                    "SGHQuali": 1200.00,
                    "Portal de Compras": 840.00,
                    "Chamada Digital": 180.00,
                    "EFD REINF": 360.00,
                    "SPD STORAGE": 0,
                    "E-Social": 0,
                    "Aplicação Web Custos": 300.00,
                    "CEMEX": "ñ participa",
                    "Interação API (Laudos)": 180.00,
                    "SGH Intelligence Web": 0,
                    "SGH Intelligence Custos": 300.00,
                    "Painel Estatístico_Gestão a Vista (Web/CS)": 360.00,
                    "Gerador de Relatorios": 0,
                    "Central de reservas de Leitos": 300.00
                },
                "Acima de 200": {
                    "Faturamento de AIH": 1920.00,
                    "Faturamento de Ambulatório": 1440.00,
                    "Faturamento de Convênios": 0,
                    "Controle de Estoque": 1200.00,
                    "Recepção Interna": 780.00,
                    "Recepção Externa": 780.00,
                    "SADT - Radiologia": 540.00,
                    "SADT - Laboratório": 660.00,
                    "SADT - Endoscopia": 540.00,
                    "SADT - Anatomia Patológica": 540.00,
                    "SADT - Ultra-Sonografia": 540.00,
                    "Bloco Cirúrgico": 780.00,
                    "SADT - Tomografia": 540.00,
                    "Contabilidade": 900.00,
                    "Financeiro": 840.00,
                    "APAC": 1440.00,
                    "Custos": 1680.00,
                    "SADT - Hemodinâmica": 540.00,
                    "Folha de Pagamento": 1600.00,
                    "Patrimônio": 840.00,
                    "SIG - Sistema de Informações Gerenciais": 0,
                    "SADT- Outros": 540.00,
                    "Orçamento": 600.00,
                    "SADT- Ressonância Magnética": 540.00,
                    "SGHIntelligence": 1800.00,
                    "Agendamento (normal)": 180.00,
                    "Agendamento de Quimmioterapia": 240.00,
                    "Agendamento de Plantão": 180.00,
                    "SADT- Hemoterapia": 540.00,
                    "Painel Eletrônico*": 660.00,
                    "PACs (apenas Worklist)": 180.00,
                    "SPED": 120.00,
                    "Gestão de Repasse e Terceiros": 600.00,
                    "SAC *": 300.00,
                    "Controle de Acessos": 420.00,
                    "Higienização de Leitos *": 360.00,
                    "DMED": 120.00,
                    "Web Service DICOM": 360.00,
                    "Integrador Laboratório Web Service": 360.00,
                    "Integrador Laboratório WebService Padrão SPDATA": 360.00,
                    "PEP - Prontuário Eletrônico do Paciente": 300.00,
                    "Nota Fiscal Eletrônica": 0,
                    "Portal de Serviços": 480.00,
                    "Laudo Web": 300.00,
                    "SGHQuali": 1800.00,
                    "Portal de Compras": 960.00,
                    "Chamada Digital": 180.00,
                    "EFD REINF": 600.00,
                    "SPD STORAGE": 0,
                    "E-Social": 0,
                    "Aplicação Web Custos": 480.00,
                    "CEMEX": "ñ participa",
                    "Interação API (Laudos)": 180.00,
                    "SGH Intelligence Web": 0,
                    "SGH Intelligence Custos": 480.00,
                    "Painel Estatístico_Gestão a Vista (Web/CS)": 600.00,
                    "Gerador de Relatorios": 0,
                    "Central de reservas de Leitos": 360.00
                }
            },
            "demais": {
                "HOP DIA": {
                    "Faturamento de AIH": 0,
                    "Faturamento de Ambulatório": 240.00,
                    "Faturamento de Convênios": 720.00,
                    "Controle de Estoque": 480.00,
                    "Recepção Interna": 360.00,
                    "Recepção Externa": 240.00,
                    "SADT - Radiologia": 180.00,
                    "SADT - Laboratório": 420.00,
                    "SADT - Endoscopia": 240.00,
                    "SADT - Anatomia Patológica": 240.00,
                    "SADT - Ultra-Sonografia": 240.00,
                    "Bloco Cirúrgico": 240.00,
                    "SADT - Tomografia": 240.00,
                    "Contabilidade": 420.00,
                    "Financeiro": 480.00,
                    "APAC": 360.00,
                    "Custos": 360.00,
                    "SADT - Hemodinâmica": 240.00,
                    "Folha de Pagamento": 1600.00,
                    "Patrimônio": 180.00,
                    "SIG - Sistema de Informações Gerenciais": 0,
                    "SADT- Outros": 240.00,
                    "Orçamento": 180.00,
                    "SADT- Ressonância Magnética": 240.00,
                    "SGHIntelligence": 720.00,
                    "Agendamento (normal)": 180.00,
                    "Agendamento de Quimmioterapia": 240.00,
                    "Agendamento de Plantão": 180.00,
                    "SADT- Hemoterapia": 240.00,
                    "Painel Eletrônico*": 180.00,
                    "PACs (apenas Worklist)": 180.00,
                    "SPED": 120.00,
                    "Gestão de Repasse e Terceiros": 300.00,
                    "SAC *": 0,
                    "Controle de Acessos": 180.00,
                    "Higienização de Leitos *": 120.00,
                    "DMED": 120.00,
                    "Web Service DICOM": 120.00,
                    "Integrador Laboratório Web Service": 120.00,
                    "Integrador Laboratório WebService Padrão SPDATA": 120.00,
                    "PEP - Prontuário Eletrônico do Paciente": 120.00,
                    "Nota Fiscal Eletrônica": 180.00,
                    "Portal de Serviços": 180.00,
                    "Laudo Web": 120.00,
                    "SGHQuali": 720.00,
                    "Portal de Compras": 480.00,
                    "Chamada Digital": 180.00,
                    "EFD REINF": 180.00,
                    "SPD STORAGE": 0,
                    "E-Social": 0,
                    "Aplicação Web Custos": 240.00,
                    "CEMEX": 950.00,
                    "Interação API (Laudos)": 180.00,
                    "SGH Intelligence Web": 0,
                    "SGH Intelligence Custos": 240.00,
                    "Painel Estatístico_Gestão a Vista (Web/CS)": 180.00,
                    "Gerador de Relatorios": 0,
                    "Central de reservas de Leitos": 0
                },
                "CLINICAS I": {
                    "Faturamento de AIH": 0,
                    "Faturamento de Ambulatório": 0,
                    "Faturamento de Convênios": 360.00,
                    "Controle de Estoque": 240.00,
                    "Recepção Interna": 0,
                    "Recepção Externa": 240.00,
                    "SADT - Radiologia": 180.00,
                    "SADT - Laboratório": 420.00,
                    "SADT - Endoscopia": 240.00,
                    "SADT - Anatomia Patológica": 240.00,
                    "SADT - Ultra-Sonografia": 240.00,
                    "Bloco Cirúrgico": 240.00,
                    "SADT - Tomografia": 240.00,
                    "Contabilidade": 300.00,
                    "Financeiro": 360.00,
                    "APAC": 0,
                    "Custos": 420.00,
                    "SADT - Hemodinâmica": 240.00,
                    "Folha de Pagamento": 1600.00,
                    "Patrimônio": 180.00,
                    "SIG - Sistema de Informações Gerenciais": 0,
                    "SADT- Outros": 240.00,
                    "Orçamento": 120.00,
                    "SADT- Ressonância Magnética": 240.00,
                    "SGHIntelligence": 720.00,
                    "Agendamento (normal)": 180.00,
                    "Agendamento de Quimmioterapia": 240.00,
                    "Agendamento de Plantão": 180.00,
                    "SADT- Hemoterapia": 240.00,
                    "Painel Eletrônico*": 180.00,
                    "PACs (apenas Worklist)": 180.00,
                    "SPED": 120.00,
                    "Gestão de Repasse e Terceiros": 300.00,
                    "SAC *": 0,
                    "Controle de Acessos": 180.00,
                    "Higienização de Leitos *": 0,
                    "DMED": 120.00,
                    "Web Service DICOM": 120.00,
                    "Integrador Laboratório Web Service": 120.00,
                    "Integrador Laboratório WebService Padrão SPDATA": 120.00,
                    "PEP - Prontuário Eletrônico do Paciente": 120.00,
                    "Nota Fiscal Eletrônica": 180.00,
                    "Portal de Serviços": 180.00,
                    "Laudo Web": 120.00,
                    "SGHQuali": 720.00,
                    "Portal de Compras": 660.00,
                    "Chamada Digital": 180.00,
                    "EFD REINF": 300.00,
                    "SPD STORAGE": 0,
                    "E-Social": 0,
                    "Aplicação Web Custos": 240.00,
                    "CEMEX": 950.00,
                    "Interação API (Laudos)": 180.00,
                    "SGH Intelligence Web": 0,
                    "SGH Intelligence Custos": 240.00,
                    "Painel Estatístico_Gestão a Vista (Web/CS)": 180.00,
                    "Gerador de Relatorios": 0,
                    "Central de reservas de Leitos": 0
                },
                "CLINICAS II": {
                    "Faturamento de AIH": 0,
                    "Faturamento de Ambulatório": 0,
                    "Faturamento de Convênios": 600.00,
                    "Controle de Estoque": 360.00,
                    "Recepção Interna": 0,
                    "Recepção Externa": 360.00,
                    "SADT - Radiologia": 300.00,
                    "SADT - Laboratório": 480.00,
                    "SADT - Endoscopia": 360.00,
                    "SADT - Anatomia Patológica": 360.00,
                    "SADT - Ultra-Sonografia": 360.00,
                    "Bloco Cirúrgico": 360.00,
                    "SADT - Tomografia": 360.00,
                    "Contabilidade": 360.00,
                    "Financeiro": 360.00,
                    "APAC": 0,
                    "Custos": 480.00,
                    "SADT - Hemodinâmica": 360.00,
                    "Folha de Pagamento": 1600.00,
                    "Patrimônio": 240.00,
                    "SIG - Sistema de Informações Gerenciais": 0,
                    "SADT- Outros": 360.00,
                    "Orçamento": 180.00,
                    "SADT- Ressonância Magnética": 360.00,
                    "SGHIntelligence": 960.00,
                    "Agendamento (normal)": 180.00,
                    "Agendamento de Quimmioterapia": 240.00,
                    "Agendamento de Plantão": 180.00,
                    "SADT- Hemoterapia": 360.00,
                    "Painel Eletrônico*": 240.00,
                    "PACs (apenas Worklist)": 180.00,
                    "SPED": 120.00,
                    "Gestão de Repasse e Terceiros": 300.00,
                    "SAC *": 0,
                    "Controle de Acessos": 300.00,
                    "Higienização de Leitos *": 0,
                    "DMED": 120.00,
                    "Web Service DICOM": 180.00,
                    "Integrador Laboratório Web Service": 180.00,
                    "Integrador Laboratório WebService Padrão SPDATA": 180.00,
                    "PEP - Prontuário Eletrônico do Paciente": 180.00,
                    "Nota Fiscal Eletrônica": 240.00,
                    "Portal de Serviços": 240.00,
                    "Laudo Web": 180.00,
                    "SGHQuali": 960.00,
                    "Portal de Compras": 816.00,
                    "Chamada Digital": 180.00,
                    "EFD REINF": 300.00,
                    "SPD STORAGE": 0,
                    "E-Social": 0,
                    "Aplicação Web Custos": 240.00,
                    "CEMEX": 1230.00,
                    "Interação API (Laudos)": 180.00,
                    "SGH Intelligence Web": 0,
                    "SGH Intelligence Custos": 240.00,
                    "Painel Estatístico_Gestão a Vista (Web/CS)": 240.00,
                    "Gerador de Relatorios": 0,
                    "Central de reservas de Leitos": 0
                },
                "CLINICAS III": {
                    "Faturamento de AIH": 0,
                    "Faturamento de Ambulatório": 0,
                    "Faturamento de Convênios": 960.00,
                    "Controle de Estoque": 480.00,
                    "Recepção Interna": 0,
                    "Recepção Externa": 480.00,
                    "SADT - Radiologia": 360.00,
                    "SADT - Laboratório": 540.00,
                    "SADT - Endoscopia": 480.00,
                    "SADT - Anatomia Patológica": 480.00,
                    "SADT - Ultra-Sonografia": 480.00,
                    "Bloco Cirúrgico": 480.00,
                    "SADT - Tomografia": 480.00,
                    "Contabilidade": 420.00,
                    "Financeiro": 360.00,
                    "APAC": 0,
                    "Custos": 840.00,
                    "SADT - Hemodinâmica": 480.00,
                    "Folha de Pagamento": 1600.00,
                    "Patrimônio": 300.00,
                    "SIG - Sistema de Informações Gerenciais": 0,
                    "SADT- Outros": 480.00,
                    "Orçamento": 240.00,
                    "SADT- Ressonância Magnética": 480.00,
                    "SGHIntelligence": 1200.00,
                    "Agendamento (normal)": 180.00,
                    "Agendamento de Quimmioterapia": 240.00,
                    "Agendamento de Plantão": 180.00,
                    "SADT- Hemoterapia": 480.00,
                    "Painel Eletrônico*": 360.00,
                    "PACs (apenas Worklist)": 180.00,
                    "SPED": 120.00,
                    "Gestão de Repasse e Terceiros": 300.00,
                    "SAC *": 0,
                    "Controle de Acessos": 360.00,
                    "Higienização de Leitos *": 0,
                    "DMED": 120.00,
                    "Web Service DICOM": 240.00,
                    "Integrador Laboratório Web Service": 240.00,
                    "Integrador Laboratório WebService Padrão SPDATA": 240.00,
                    "PEP - Prontuário Eletrônico do Paciente": 240.00,
                    "Nota Fiscal Eletrônica": 300.00,
                    "Portal de Serviços": 360.00,
                    "Laudo Web": 240.00,
                    "SGHQuali": 1200.00,
                    "Portal de Compras": 960.00,
                    "Chamada Digital": 180.00,
                    "EFD REINF": 300.00,
                    "SPD STORAGE": 0,
                    "E-Social": 0,
                    "Aplicação Web Custos": 240.00,
                    "CEMEX": 1650.00,
                    "Interação API (Laudos)": 180.00,
                    "SGH Intelligence Web": 0,
                    "SGH Intelligence Custos": 240.00,
                    "Painel Estatístico_Gestão a Vista (Web/CS)": 360.00,
                    "Gerador de Relatorios": 0,
                    "Central de reservas de Leitos": 0
                },
                "UPA I": {
                    "Faturamento de AIH": 0,
                    "Faturamento de Ambulatório": 480.00,
                    "Faturamento de Convênios": 0,
                    "Controle de Estoque": 360.00,
                    "Recepção Interna": 0,
                    "Recepção Externa": 240.00,
                    "SADT - Radiologia": 180.00,
                    "SADT - Laboratório": 420.00,
                    "SADT - Endoscopia": 240.00,
                    "SADT - Anatomia Patológica": 240.00,
                    "SADT - Ultra-Sonografia": 240.00,
                    "Bloco Cirúrgico": 240.00,
                    "SADT - Tomografia": 240.00,
                    "Contabilidade": 0,
                    "Financeiro": 360.00,
                    "APAC": 0,
                    "Custos": 420.00,
                    "SADT - Hemodinâmica": 240.00,
                    "Folha de Pagamento": 1600.00,
                    "Patrimônio": 180.00,
                    "SIG - Sistema de Informações Gerenciais": 0,
                    "SADT- Outros": 240.00,
                    "Orçamento": 120.00,
                    "SADT- Ressonância Magnética": 240.00,
                    "SGHIntelligence": 720.00,
                    "Agendamento (normal)": 180.00,
                    "Agendamento de Quimmioterapia": 240.00,
                    "Agendamento de Plantão": 180.00,
                    "SADT- Hemoterapia": 240.00,
                    "Painel Eletrônico*": 180.00,
                    "PACs (apenas Worklist)": 180.00,
                    "SPED": 120.00,
                    "Gestão de Repasse e Terceiros": 0,
                    "SAC *": 0,
                    "Controle de Acessos": 180.00,
                    "Higienização de Leitos *": 0,
                    "DMED": 120.00,
                    "Web Service DICOM": 120.00,
                    "Integrador Laboratório Web Service": 120.00,
                    "Integrador Laboratório WebService Padrão SPDATA": 120.00,
                    "PEP - Prontuário Eletrônico do Paciente": 120.00,
                    "Nota Fiscal Eletrônica": 0,
                    "Portal de Serviços": 180.00,
                    "Laudo Web": 120.00,
                    "SGHQuali": 720.00,
                    "Portal de Compras": 0,
                    "Chamada Digital": 180.00,
                    "EFD REINF": 300.00,
                    "SPD STORAGE": 0,
                    "E-Social": 0,
                    "Aplicação Web Custos": 240.00,
                    "CEMEX": 0,
                    "Interação API (Laudos)": 180.00,
                    "SGH Intelligence Web": 0,
                    "SGH Intelligence Custos": 240.00,
                    "Painel Estatístico_Gestão a Vista (Web/CS)": 180.00,
                    "Gerador de Relatorios": 0,
                    "Central de reservas de Leitos": 0
                },
                "UPAII": {
                    "Faturamento de AIH": 0,
                    "Faturamento de Ambulatório": 600.00,
                    "Faturamento de Convênios": 0,
                    "Controle de Estoque": 540.00,
                    "Recepção Interna": 0,
                    "Recepção Externa": 360.00,
                    "SADT - Radiologia": 300.00,
                    "SADT - Laboratório": 480.00,
                    "SADT - Endoscopia": 360.00,
                    "SADT - Anatomia Patológica": 360.00,
                    "SADT - Ultra-Sonografia": 360.00,
                    "Bloco Cirúrgico": 360.00,
                    "SADT - Tomografia": 360.00,
                    "Contabilidade": 0,
                    "Financeiro": 480.00,
                    "APAC": 0,
                    "Custos": 480.00,
                    "SADT - Hemodinâmica": 360.00,
                    "Folha de Pagamento": 1600.00,
                    "Patrimônio": 240.00,
                    "SIG - Sistema de Informações Gerenciais": 0,
                    "SADT- Outros": 360.00,
                    "Orçamento": 180.00,
                    "SADT- Ressonância Magnética": 360.00,
                    "SGHIntelligence": 960.00,
                    "Agendamento (normal)": 180.00,
                    "Agendamento de Quimmioterapia": 240.00,
                    "Agendamento de Plantão": 180.00,
                    "SADT- Hemoterapia": 360.00,
                    "Painel Eletrônico*": 240.00,
                    "PACs (apenas Worklist)": 180.00,
                    "SPED": 120.00,
                    "Gestão de Repasse e Terceiros": 0,
                    "SAC *": 0,
                    "Controle de Acessos": 300.00,
                    "Higienização de Leitos *": 0,
                    "DMED": 120.00,
                    "Web Service DICOM": 180.00,
                    "Integrador Laboratório Web Service": 180.00,
                    "Integrador Laboratório WebService Padrão SPDATA": 180.00,
                    "PEP - Prontuário Eletrônico do Paciente": 180.00,
                    "Nota Fiscal Eletrônica": 0,
                    "Portal de Serviços": 240.00,
                    "Laudo Web": 180.00,
                    "SGHQuali": 960.00,
                    "Portal de Compras": 0,
                    "Chamada Digital": 180.00,
                    "EFD REINF": 300.00,
                    "SPD STORAGE": 0,
                    "E-Social": 0,
                    "Aplicação Web Custos": 240.00,
                    "CEMEX": 0,
                    "Interação API (Laudos)": 180.00,
                    "SGH Intelligence Web": 0,
                    "SGH Intelligence Custos": 240.00,
                    "Painel Estatístico_Gestão a Vista (Web/CS)": 240.00,
                    "Gerador de Relatorios": 0,
                    "Central de reservas de Leitos": 0
                },
                "UPA III": {
                    "Faturamento de AIH": 0,
                    "Faturamento de Ambulatório": 840.00,
                    "Faturamento de Convênios": 0,
                    "Controle de Estoque": 720.00,
                    "Recepção Interna": 0,
                    "Recepção Externa": 480.00,
                    "SADT - Radiologia": 360.00,
                    "SADT - Laboratório": 540.00,
                    "SADT - Endoscopia": 480.00,
                    "SADT - Anatomia Patológica": 480.00,
                    "SADT - Ultra-Sonografia": 480.00,
                    "Bloco Cirúrgico": 480.00,
                    "SADT - Tomografia": 480.00,
                    "Contabilidade": 0,
                    "Financeiro": 600.00,
                    "APAC": 0,
                    "Custos": 840.00,
                    "SADT - Hemodinâmica": 480.00,
                    "Folha de Pagamento": 1600.00,
                    "Patrimônio": 300.00,
                    "SIG - Sistema de Informações Gerenciais": 0,
                    "SADT- Outros": 480.00,
                    "Orçamento": 240.00,
                    "SADT- Ressonância Magnética": 480.00,
                    "SGHIntelligence": 1200.00,
                    "Agendamento (normal)": 180.00,
                    "Agendamento de Quimmioterapia": 240.00,
                    "Agendamento de Plantão": 180.00,
                    "SADT- Hemoterapia": 480.00,
                    "Painel Eletrônico*": 360.00,
                    "PACs (apenas Worklist)": 180.00,
                    "SPED": 120.00,
                    "Gestão de Repasse e Terceiros": 0,
                    "SAC *": 0,
                    "Controle de Acessos": 360.00,
                    "Higienização de Leitos *": 0,
                    "DMED": 120.00,
                    "Web Service DICOM": 240.00,
                    "Integrador Laboratório Web Service": 240.00,
                    "Integrador Laboratório WebService Padrão SPDATA": 240.00,
                    "PEP - Prontuário Eletrônico do Paciente": 240.00,
                    "Nota Fiscal Eletrônica": 0,
                    "Portal de Serviços": 360.00,
                    "Laudo Web": 240.00,
                    "SGHQuali": 1200.00,
                    "Portal de Compras": 0,
                    "Chamada Digital": 180.00,
                    "EFD REINF": 360.00,
                    "SPD STORAGE": 0,
                    "E-Social": 0,
                    "Aplicação Web Custos": 240.00,
                    "CEMEX": 0,
                    "Interação API (Laudos)": 180.00,
                    "SGH Intelligence Web": 0,
                    "SGH Intelligence Custos": 240.00,
                    "Painel Estatístico_Gestão a Vista (Web/CS)": 360.00,
                    "Gerador de Relatorios": 0,
                    "Central de reservas de Leitos": 0
                }
            },
            "special": {
                "Agendamento Online": {
                    "pacientes": {
                        "1000": 320.00,
                        "5000": 450.00,
                        "mais": 615.00
                    },
                    "callcenter": {
                        "1000": 415.00,
                        "5000": 530.00,
                        "10000": 700.00,
                        "15000": 830.00,
                        "mais": 950.00
                    }
                },
                "CARTÃO DE DESCONTO": {
                    "5000": 720.00,
                    "7500": 1080.00,
                    "10000": 1440.00,
                    "mais": 1800.00
                },
                "SGO": {
                    "valorPorVida": 1.20,
                    "minimo": 3000.00,
                    "mobile": 500.00,
                    "portal": 500.00
                },
                "SMS": {
                    "1000": 180.00,
                    "5000": 720.00,
                    "10000": 1200.00
                },
                "implantacao": {
                    // Valores de implantação atualizados conforme planilha "taxa de implantação.xlsx"
                    "Faturamento de AIH": 5600.00,
                    "Faturamento de Ambulatório": 5600.00,
                    "Faturamento de Convênios": 7875.00,
                    "Controle de Estoque": 21875.00,
                    "Recepção Interna": 4200.00,
                    "Recepção Externa": 3675.00,
                    "SADT - Radiologia": 2100.00,
                    "SADT - Laboratório": 7175.00,
                    "SADT - Endoscopia": 2100.00,
                    "SADT - Anatomia Patológica": 2100.00,
                    "SADT - Ultra-Sonografia": 2100.00,
                    "Bloco Cirúrgico": 2275.00,
                    "SADT - Tomografia": 2100.00,
                    "Contabilidade": 0, // Não consta na planilha
                    "Financeiro": 7000.00,
                    "APAC": 5600.00,
                    "Custos": 16800.00,
                    "SADT - Hemodinâmica": 2100.00,
                    "Folha de Pagamento": 0, // Não consta
                    "Patrimônio": 0, // Não consta
                    "SIG - Sistema de Informações Gerenciais": 0,
                    "SADT- Outros": 700.00,
                    "Orçamento": 0, // Não consta
                    "SADT- Ressonância Magnética": 2100.00,
                    "SGHIntelligence": 0, // Não consta
                    "Agendamento (normal)": 1050.00,
                    "Agendamento de Quimmioterapia": 0, // Não consta
                    "Agendamento de Plantão": 0, // Não consta
                    "SADT- Hemoterapia": 0, // Não consta
                    "Painel Eletrônico*": 0, // Não consta
                    "PACs (apenas Worklist)": 0, // Não consta
                    "SPED": 1050.00,
                    "Gestão de Repasse e Terceiros": 0, // Não consta
                    "SAC *": 0, // Não consta
                    "Controle de Acessos": 0, // Não consta
                    "Higienização de Leitos *": 2975.00,
                    "DMED": 0, // Não consta
                    "Web Service DICOM": 0, // Não consta
                    "Integrador Laboratório Web Service": 4375.00,
                    "Integrador Laboratório WebService Padrão SPDATA": 4375.00,
                    "PEP - Prontuário Eletrônico do Paciente": 67725.00,
                    "Nota Fiscal Eletrônica": 2100.00,
                    "Portal de Serviços": 4200.00,
                    "Laudo Web": 4375.00,
                    "SGHQuali": 2000.00,
                    "Portal de Compras": 0, // Não consta
                    "Chamada Digital": 2100.00,
                    "EFD REINF": 0, // Não consta
                    "SPD STORAGE": 4200.00,
                    "E-Social": 0,
                    "Aplicação Web Custos": 7700.00,
                    "CEMEX": 0, // Não consta
                    "Interação API (Laudos)": 2800.00,
                    "SGH Intelligence Web": 4000.00,
                    "SGH Intelligence Custos": 0, // Não consta
                    "Painel Estatístico_Gestão a Vista (Web/CS)": 3675.00,
                    "Gerador de Relatorios": 1050.00,
                    "Central de reservas de Leitos": 0, // Não consta

                    // Módulos especiais
                    "Agendamento Online": 7000.00, // Call Center até 1000
                    "CARTÃO DE DESCONTO": 0, // Não definido na planilha, manter 0 por enquanto
                    "SGO": 3000.00, // Valor mínimo
                    "SMS": 0 // Não consta
                }
            }
        };

        // Lista de todos os módulos
        const allModules = [
            "Faturamento de AIH",
            "Faturamento de Ambulatório",
            "Faturamento de Convênios",
            "Controle de Estoque",
            "Recepção Interna",
            "Recepção Externa",
            "SADT - Radiologia",
            "SADT - Laboratório",
            "SADT - Endoscopia",
            "SADT - Anatomia Patológica",
            "SADT - Ultra-Sonografia",
            "Bloco Cirúrgico",
            "SADT - Tomografia",
            "Contabilidade",
            "Financeiro",
            "APAC",
            "Custos",
            "SADT - Hemodinâmica",
            "Folha de Pagamento",
            "Patrimônio",
            "SIG - Sistema de Informações Gerenciais",
            "SADT- Outros",
            "Orçamento",
            "SADT- Ressonância Magnética",
            "SGHIntelligence",
            "Agendamento (normal)",
            "Agendamento de Quimmioterapia",
            "Agendamento de Plantão",
            "SADT- Hemoterapia",
            "Painel Eletrônico*",
            "PACs (apenas Worklist)",
            "SPED",
            "Gestão de Repasse e Terceiros",
            "SAC *",
            "Controle de Acessos",
            "Higienização de Leitos *",
            "DMED",
            "Web Service DICOM",
            "Integrador Laboratório Web Service",
            "Integrador Laboratório WebService Padrão SPDATA",
            "PEP - Prontuário Eletrônico do Paciente",
            "Nota Fiscal Eletrônica",
            "Portal de Serviços",
            "Laudo Web",
            "SGHQuali",
            "Portal de Compras",
            "Chamada Digital",
            "EFD REINF",
            "SPD STORAGE",
            "E-Social",
            "Aplicação Web Custos",
            "CEMEX",
            "Interação API (Laudos)",
            "SGH Intelligence Web",
            "SGH Intelligence Custos",
            "Painel Estatístico_Gestão a Vista (Web/CS)",
            "Gerador de Relatorios",
            "Central de reservas de Leitos",
            "Agendamento Online",
            "CARTÃO DE DESCONTO",
            "SGO",
            "SMS"
        ];

        // Módulos do pacote SGH ESSENCIAL
        const sghEssencialModules = [
            "Faturamento de AIH",
            "Faturamento de Ambulatório",
            "Faturamento de Convênios",
            "DMED",
            "Chamada Digital",
            "Recepção Interna",
            "Recepção Externa",
            "PEP - Prontuário Eletrônico do Paciente",
            "Controle de Estoque",
            "Financeiro",
            "Painel Estatístico_Gestão a Vista (Web/CS)"
        ];

        // Inicializa os eventos e carrega dados salvos
        document.addEventListener('DOMContentLoaded', function() {
            setupTabs();
            setupEstablishmentChangeListener();
            setupProposalTypeButtons();
            loadModules();
            loadAdminModuleLists();
            loadSavedData();
            loadProposalHistory();
        });

        function setupTabs() {
            document.querySelectorAll('.tab').forEach(tab => {
                tab.addEventListener('click', function() {
                    document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
                    document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
                    this.classList.add('active');
                    const tabId = this.getAttribute('data-tab');
                    document.getElementById(tabId).classList.add('active');
                });
            });
        }

        function setupEstablishmentChangeListener() {
            document.getElementById('establishment').addEventListener('change', updateBedRangeOptions);
        }

        function updateBedRangeOptions() {
            const establishment = document.getElementById('establishment').value;
            const bedRangeSelect = document.getElementById('bedRange');
            bedRangeSelect.innerHTML = '<option value="">Selecione...</option>';

            if (establishment === 'demais') {
                const options = ["HOP DIA", "CLINICAS I", "CLINICAS II", "CLINICAS III", "UPA I", "UPAII", "UPA III"];
                options.forEach(opt => {
                    const option = document.createElement('option');
                    option.value = opt;
                    option.textContent = opt;
                    bedRangeSelect.appendChild(option);
                });
            } else {
                const options = ["1 a 50 leitos", "51 a 100", "101 a 200", "Acima de 200"];
                options.forEach(opt => {
                    const option = document.createElement('option');
                    option.value = opt;
                    option.textContent = opt;
                    bedRangeSelect.appendChild(option);
                });
            }
        }

        function setupProposalTypeButtons() {
            document.querySelectorAll('.proposal-type-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    document.querySelectorAll('.proposal-type-btn').forEach(b => b.classList.remove('active'));
                    this.classList.add('active');

                    const type = this.getAttribute('data-type');
                    applyProposalType(type);
                });
            });
        }

        function applyProposalType(type) {
            document.querySelectorAll('#modulesList input[type="checkbox"]').forEach(cb => {
                cb.checked = false;
            });

            if (type === 'essencial') {
                sghEssencialModules.forEach(moduleName => {
                    const checkboxId = `module_${moduleName.replace(/[^a-zA-Z0-9]/g, '_')}`;
                    const checkbox = document.getElementById(checkboxId);
                    if (checkbox) {
                        checkbox.checked = true;
                    }
                });
            } else if (type === 'todas') {
                document.querySelectorAll('#modulesList input[type="checkbox"]').forEach(cb => {
                    cb.checked = true;
                });
            }

            updateSpecialConfigsVisibility();
        }

        function updateSpecialConfigsVisibility() {
            const specialModules = ["Agendamento Online", "CARTÃO DE DESCONTO", "SGO", "SMS"];
            specialModules.forEach(moduleName => {
                const checkboxId = `module_${moduleName.replace(/[^a-zA-Z0-9]/g, '_')}`;
                const checkbox = document.getElementById(checkboxId);
                const configId = {
                    "Agendamento Online": "agendamentoConfig",
                    "CARTÃO DE DESCONTO": "cartaoConfig",
                    "SGO": "sgoConfig",
                    "SMS": "smsConfig"
                }[moduleName];

                if (checkbox && configId) {
                    document.getElementById(configId).style.display = checkbox.checked ? 'block' : 'none';
                }
            });
        }

        function loadModules() {
            const modulesList = document.getElementById('modulesList');
            modulesList.innerHTML = '';

            allModules.forEach(moduleName => {
                const div = document.createElement('div');
                div.className = 'module-item';

                const checkbox = document.createElement('input');
                checkbox.type = 'checkbox';
                checkbox.id = `module_${moduleName.replace(/[^a-zA-Z0-9]/g, '_')}`;
                checkbox.value = moduleName;
                checkbox.dataset.module = moduleName;

                const label = document.createElement('label');
                label.htmlFor = checkbox.id;
                label.textContent = moduleName;

                div.appendChild(checkbox);
                div.appendChild(label);
                modulesList.appendChild(div);

                checkbox.addEventListener('change', function() {
                    const configs = {
                        "Agendamento Online": "agendamentoConfig",
                        "CARTÃO DE DESCONTO": "cartaoConfig",
                        "SGO": "sgoConfig",
                        "SMS": "smsConfig"
                    };

                    const configId = configs[moduleName];
                    if (configId) {
                        document.getElementById(configId).style.display = this.checked ? 'block' : 'none';
                    }
                });
            });
        }

        function loadAdminModuleLists() {
            const select = document.getElementById('adminModuleSelect');
            select.innerHTML = '<option value="">-- Selecione um Módulo --</option>';

            const implantSelect = document.getElementById('adminImplantModuleSelect');
            implantSelect.innerHTML = '<option value="">-- Selecione um Módulo --</option>';

            allModules.forEach(moduleName => {
                if (!["Agendamento Online", "CARTÃO DE DESCONTO", "SGO", "SMS"].includes(moduleName)) {
                    const option = document.createElement('option');
                    option.value = moduleName;
                    option.textContent = moduleName;
                    select.appendChild(option);

                    const implantOption = document.createElement('option');
                    implantOption.value = moduleName;
                    implantOption.textContent = moduleName;
                    implantSelect.appendChild(implantOption);
                }
            });

            select.addEventListener('change', function() {
                generateAdminInputs(this.value);
            });

            implantSelect.addEventListener('change', function() {
                generateImplantAdminInputs(this.value);
            });

            document.getElementById('adminSpecialModuleSelect').addEventListener('change', function() {
                generateSpecialAdminInputs(this.value);
            });
        }

        function generateAdminInputs(moduleName) {
            if (!moduleName) {
                document.getElementById('adminValueInputs').innerHTML = '';
                return;
            }

            let html = `<h4>Edite os valores mensais para: ${moduleName}</h4>`;

            for (let estab in pricingData) {
                if (estab === 'special') continue;
                html += `<h5>${estab.toUpperCase()}</h5>`;
                for (let range in pricingData[estab]) {
                    const value = pricingData[estab][range][moduleName] || 0;
                    const key = `${estab}_${range}_${moduleName.replace(/[^a-zA-Z0-9]/g, '_')}`;
                    html += `
                        <div class="form-group">
                            <label>${range}:</label>
                            <input type="number" step="0.01" class="admin-input" data-key="${key}" value="${value}" style="width: 100%; padding: 8px;">
                        </div>
                    `;
                }
            }

            document.getElementById('adminValueInputs').innerHTML = html;
        }

        function generateImplantAdminInputs(moduleName) {
            if (!moduleName) {
                document.getElementById('adminImplantValueInputs').innerHTML = '';
                return;
            }

            let html = `<h4>Edite o valor de implantação para: ${moduleName}</h4>`;

            const implantValue = pricingData.special.implantacao[moduleName] || 0;
            html += `
                <div class="form-group">
                    <label>Valor de Implantação (R$):</label>
                    <input type="number" step="0.01" id="implantValueInput" value="${implantValue}" style="width: 100%; padding: 8px;">
                </div>
            `;

            document.getElementById('adminImplantValueInputs').innerHTML = html;
        }

        function generateSpecialAdminInputs(moduleName) {
            if (!moduleName) {
                document.getElementById('adminSpecialValueInputs').innerHTML = '';
                return;
            }

            let html = `<h4>Edite os valores para: ${moduleName}</h4>`;

            switch(moduleName) {
                case "Agendamento Online":
                    html += `
                        <h5>Pacientes</h5>
                        <div class="form-group">
                            <label>Até 1.000: R$</label>
                            <input type="number" step="0.01" class="special-admin-input" data-key="AgendamentoOnline_pacientes_1000" value="${pricingData.special.AgendamentoOnline.pacientes['1000']}" style="width: 100%; padding: 8px;">
                        </div>
                        <div class="form-group">
                            <label>5.000: R$</label>
                            <input type="number" step="0.01" class="special-admin-input" data-key="AgendamentoOnline_pacientes_5000" value="${pricingData.special.AgendamentoOnline.pacientes['5000']}" style="width: 100%; padding: 8px;">
                        </div>
                        <div class="form-group">
                            <label>Acima: R$</label>
                            <input type="number" step="0.01" class="special-admin-input" data-key="AgendamentoOnline_pacientes_mais" value="${pricingData.special.AgendamentoOnline.pacientes['mais']}" style="width: 100%; padding: 8px;">
                        </div>
                        <h5>Call Center</h5>
                        <div class="form-group">
                            <label>Até 1.000: R$</label>
                            <input type="number" step="0.01" class="special-admin-input" data-key="AgendamentoOnline_callcenter_1000" value="${pricingData.special.AgendamentoOnline.callcenter['1000']}" style="width: 100%; padding: 8px;">
                        </div>
                        <div class="form-group">
                            <label>5.000: R$</label>
                            <input type="number" step="0.01" class="special-admin-input" data-key="AgendamentoOnline_callcenter_5000" value="${pricingData.special.AgendamentoOnline.callcenter['5000']}" style="width: 100%; padding: 8px;">
                        </div>
                        <div class="form-group">
                            <label>10.000: R$</label>
                            <input type="number" step="0.01" class="special-admin-input" data-key="AgendamentoOnline_callcenter_10000" value="${pricingData.special.AgendamentoOnline.callcenter['10000']}" style="width: 100%; padding: 8px;">
                        </div>
                    `;
                    break;

                case "CARTÃO DE DESCONTO":
                    html += `
                        <div class="form-group">
                            <label>Até 5.000 vidas: R$</label>
                            <input type="number" step="0.01" class="special-admin-input" data-key="CARTAO_DESCONTO_5000" value="${pricingData.special['CARTÃO DE DESCONTO']['5000']}" style="width: 100%; padding: 8px;">
                        </div>
                        <div class="form-group">
                            <label>7.500 vidas: R$</label>
                            <input type="number" step="0.01" class="special-admin-input" data-key="CARTAO_DESCONTO_7500" value="${pricingData.special['CARTÃO DE DESCONTO']['7500']}" style="width: 100%; padding: 8px;">
                        </div>
                        <div class="form-group">
                            <label>10.000 vidas: R$</label>
                            <input type="number" step="0.01" class="special-admin-input" data-key="CARTAO_DESCONTO_10000" value="${pricingData.special['CARTÃO DE DESCONTO']['10000']}" style="width: 100%; padding: 8px;">
                        </div>
                        <div class="form-group">
                            <label>Acima: R$</label>
                            <input type="number" step="0.01" class="special-admin-input" data-key="CARTAO_DESCONTO_mais" value="${pricingData.special['CARTÃO DE DESCONTO']['mais']}" style="width: 100%; padding: 8px;">
                        </div>
                    `;
                    break;

                case "SGO":
                    html += `
                        <div class="form-group">
                            <label>Valor por Vida: R$</label>
                            <input type="number" step="0.01" class="special-admin-input" data-key="SGO_valorPorVida" value="${pricingData.special.SGO.valorPorVida}" style="width: 100%; padding: 8px;">
                        </div>
                        <div class="form-group">
                            <label>Valor Mínimo: R$</label>
                            <input type="number" step="0.01" class="special-admin-input" data-key="SGO_minimo" value="${pricingData.special.SGO.minimo}" style="width: 100%; padding: 8px;">
                        </div>
                        <div class="form-group">
                            <label>Beneficiário Mobile: R$</label>
                            <input type="number" step="0.01" class="special-admin-input" data-key="SGO_mobile" value="${pricingData.special.SGO.mobile}" style="width: 100%; padding: 8px;">
                        </div>
                        <div class="form-group">
                            <label>Portal Autorizador: R$</label>
                            <input type="number" step="0.01" class="special-admin-input" data-key="SGO_portal" value="${pricingData.special.SGO.portal}" style="width: 100%; padding: 8px;">
                        </div>
                    `;
                    break;

                case "SMS":
                    html += `
                        <div class="form-group">
                            <label>1.000 SMS: R$</label>
                            <input type="number" step="0.01" class="special-admin-input" data-key="SMS_1000" value="${pricingData.special.SMS['1000']}" style="width: 100%; padding: 8px;">
                        </div>
                        <div class="form-group">
                            <label>5.000 SMS: R$</label>
                            <input type="number" step="0.01" class="special-admin-input" data-key="SMS_5000" value="${pricingData.special.SMS['5000']}" style="width: 100%; padding: 8px;">
                        </div>
                        <div class="form-group">
                            <label>10.000 SMS: R$</label>
                            <input type="number" step="0.01" class="special-admin-input" data-key="SMS_10000" value="${pricingData.special.SMS['10000']}" style="width: 100%; padding: 8px;">
                        </div>
                    `;
                    break;
            }

            document.getElementById('adminSpecialValueInputs').innerHTML = html;
        }

        function saveAdminChanges() {
            const inputs = document.querySelectorAll('.admin-input');
            inputs.forEach(input => {
                const key = input.dataset.key;
                const value = parseFloat(input.value) || 0;

                const parts = key.split('_');
                const estab = parts[0];
                const range = parts[1];
                const moduleName = parts.slice(2).join('_').replace(/_/g, ' ');

                if (pricingData[estab] && pricingData[estab][range]) {
                    pricingData[estab][range][moduleName] = value;
                }
            });

            savePricingData();
            alert("✅ Valores mensais atualizados com sucesso!");
        }

        function saveImplantAdminChanges() {
            const moduleName = document.getElementById('adminImplantModuleSelect').value;
            if (!moduleName) {
                alert("Selecione um módulo primeiro.");
                return;
            }

            const implantValue = parseFloat(document.getElementById('implantValueInput').value) || 0;
            pricingData.special.implantacao[moduleName] = implantValue;

            savePricingData();
            alert(`✅ Valor de implantação para "${moduleName}" atualizado com sucesso!`);
        }

        function saveSpecialAdminChanges() {
            const inputs = document.querySelectorAll('.special-admin-input');
            inputs.forEach(input => {
                const key = input.dataset.key;
                const value = parseFloat(input.value) || 0;

                if (key.startsWith('AgendamentoOnline_pacientes')) {
                    const subkey = key.split('_')[2];
                    pricingData.special.AgendamentoOnline.pacientes[subkey] = value;
                } else if (key.startsWith('AgendamentoOnline_callcenter')) {
                    const subkey = key.split('_')[2];
                    pricingData.special.AgendamentoOnline.callcenter[subkey] = value;
                } else if (key.startsWith('CARTAO_DESCONTO')) {
                    const subkey = key.split('_')[2];
                    pricingData.special['CARTÃO DE DESCONTO'][subkey] = value;
                } else if (key.startsWith('SGO')) {
                    const prop = key.split('_')[1];
                    pricingData.special.SGO[prop] = value;
                } else if (key.startsWith('SMS')) {
                    const qty = key.split('_')[1];
                    pricingData.special.SMS[qty] = value;
                }
            });

            savePricingData();
            alert("✅ Valores especiais atualizados com sucesso!");
        }

        function savePricingData() {
            localStorage.setItem('spdataPricingData', JSON.stringify(pricingData));
        }

        function loadSavedData() {
            const savedData = localStorage.getItem('spdataPricingData');
            if (savedData) {
                try {
                    const parsedData = JSON.parse(savedData);
                    pricingData = parsedData;
                    console.log("✅ Valores personalizados carregados do LocalStorage.");
                } catch(e) {
                    console.error("❌ Erro ao carregar dados salvos:", e);
                }
            }
        }

        // ============= FUNÇÕES DE PROPOSTA =============

        function getSpecialModuleValue(moduleName) {
            switch(moduleName) {
                case "Agendamento Online":
                    const type = document.getElementById('agendamentoType').value;
                    const qty = parseInt(document.getElementById('agendamentoQty').value);
                    const ranges = pricingData.special[moduleName][type];

                    if (type === 'pacientes') {
                        if (qty <= 1000) return ranges["1000"];
                        else if (qty <= 5000) return ranges["5000"];
                        else return ranges["mais"];
                    } else {
                        if (qty <= 1000) return ranges["1000"];
                        else if (qty <= 5000) return ranges["5000"];
                        else if (qty <= 10000) return ranges["10000"];
                        else if (qty <= 15000) return ranges["15000"];
                        else return ranges["mais"];
                    }

                case "CARTÃO DE DESCONTO":
                    const vidas = parseInt(document.getElementById('cartaoVidas').value);
                    const cartaoRanges = pricingData.special[moduleName];

                    if (vidas <= 5000) return cartaoRanges["5000"];
                    else if (vidas <= 7500) return cartaoRanges["7500"];
                    else if (vidas <= 10000) return cartaoRanges["10000"];
                    else return cartaoRanges["mais"];

                case "SGO":
                    const beneficiarios = parseInt(document.getElementById('sgoBeneficiarios').value);
                    const sgoData = pricingData.special.SGO;
                    const mobile = document.getElementById('sgoMobile').value === 'sim' ? sgoData.mobile : 0;
                    const portal = document.getElementById('sgoPortal').value === 'sim' ? sgoData.portal : 0;

                    let valorBase = beneficiarios * sgoData.valorPorVida;
                    if (valorBase < sgoData.minimo) {
                        valorBase = sgoData.minimo;
                    }
                    return valorBase + mobile + portal;

                case "SMS":
                    const pacote = document.getElementById('smsPacote').value;
                    return pricingData.special.SMS[pacote];

                default:
                    return 0;
            }
        }

        function getImplantacaoValue(moduleName) {
            if (["Agendamento Online", "CARTÃO DE DESCONTO", "SGO", "SMS"].includes(moduleName)) {
                return pricingData.special.implantacao[moduleName] || 0;
            }

            // Retorna o valor de implantação específico do módulo
            if (pricingData.special.implantacao[moduleName]) {
                return pricingData.special.implantacao[moduleName];
            }

            // Fallback: se não tiver valor de implantação definido, retorna 0
            return 0;
        }

        function formatCurrency(value) {
            return new Intl.NumberFormat('pt-BR', {
                style: 'currency',
                currency: 'BRL',
                minimumFractionDigits: 2
            }).format(value);
        }

        function generateProposal() {
            const establishment = document.getElementById('establishment').value;
            const bedRange = document.getElementById('bedRange').value;
            const installmentCount = parseInt(document.getElementById('installmentCount').value) || 1;

            if (!establishment || !bedRange) {
                alert("⚠️ Por favor, selecione o tipo de estabelecimento e a faixa.");
                return;
            }

            const tableBody = document.getElementById('proposalTableBody');
            tableBody.innerHTML = '';

            let totalMensal = 0;
            let totalImplantacao = 0;
            let selectedModules = [];
            let isSghEssencial = false;

            const sghEssencialBtn = document.querySelector('.proposal-type-btn[data-type="essencial"]');
            if (sghEssencialBtn && sghEssencialBtn.classList.contains('active')) {
                isSghEssencial = true;
            }

            if (isSghEssencial) {
                const valorMensal = 5800.00;
                const valorImplantacao = 0;

                selectedModules.push({
                    name: "SGH ESSENCIAL (Pacote Fechado)",
                    monthly: valorMensal,
                    implantation: valorImplantacao
                });

                const row = document.createElement('tr');
                const nameCell = document.createElement('td');
                nameCell.textContent = "SGH ESSENCIAL (Pacote Fechado)";
                row.appendChild(nameCell);

                const mensalCell = document.createElement('td');
                mensalCell.textContent = formatCurrency(valorMensal);
                mensalCell.className = 'editable';
                mensalCell.dataset.type = 'mensal';
                mensalCell.addEventListener('click', makeEditable);
                row.appendChild(mensalCell);

                const implantacaoCell = document.createElement('td');
                implantacaoCell.textContent = formatCurrency(valorImplantacao);
                implantacaoCell.className = 'editable';
                implantacaoCell.dataset.type = 'implantacao';
                implantacaoCell.addEventListener('click', makeEditable);
                row.appendChild(implantacaoCell);

                tableBody.appendChild(row);

                totalMensal += valorMensal;
                totalImplantacao += valorImplantacao;
            } else {
                allModules.forEach(moduleName => {
                    const checkbox = document.getElementById(`module_${moduleName.replace(/[^a-zA-Z0-9]/g, '_')}`);
                    if (checkbox && checkbox.checked) {
                        let valorMensal = 0;

                        if (["Agendamento Online", "CARTÃO DE DESCONTO", "SGO", "SMS"].includes(moduleName)) {
                            valorMensal = getSpecialModuleValue(moduleName);
                        } else {
                            if (pricingData[establishment] && pricingData[establishment][bedRange]) {
                                valorMensal = pricingData[establishment][bedRange][moduleName] || 0;
                                if (typeof valorMensal === 'string') {
                                    valorMensal = 0;
                                }
                            }
                        }

                        if (valorMensal > 0) {
                            const valorImplantacao = getImplantacaoValue(moduleName);
                            totalMensal += valorMensal;
                            totalImplantacao += valorImplantacao;

                            selectedModules.push({
                                name: moduleName,
                                monthly: valorMensal,
                                implantation: valorImplantacao
                            });

                            const row = document.createElement('tr');
                            const nameCell = document.createElement('td');
                            nameCell.textContent = moduleName;
                            row.appendChild(nameCell);

                            const mensalCell = document.createElement('td');
                            mensalCell.textContent = formatCurrency(valorMensal);
                            mensalCell.className = 'editable';
                            mensalCell.dataset.type = 'mensal';
                            mensalCell.addEventListener('click', makeEditable);
                            row.appendChild(mensalCell);

                            const implantacaoCell = document.createElement('td');
                            implantacaoCell.textContent = formatCurrency(valorImplantacao);
                            implantacaoCell.className = 'editable';
                            implantacaoCell.dataset.type = 'implantacao';
                            implantacaoCell.addEventListener('click', makeEditable);
                            row.appendChild(implantacaoCell);

                            tableBody.appendChild(row);
                        }
                    }
                });
            }

            if (selectedModules.length === 0) {
                alert("⚠️ Selecione pelo menos um módulo.");
                return;
            }

            const totalGeral = totalMensal + totalImplantacao;
            const parcelaValor = totalImplantacao / installmentCount;
            const parcelaTotal = parcelaValor * installmentCount;

            document.getElementById('totalMensal').textContent = formatCurrency(totalMensal);
            document.getElementById('totalImplantacao').textContent = formatCurrency(totalImplantacao);
            document.getElementById('totalGeral').textContent = formatCurrency(totalGeral);
            document.getElementById('parcelaValor').textContent = formatCurrency(parcelaValor);
            document.getElementById('parcelaTotal').textContent = formatCurrency(parcelaTotal);
            document.getElementById('formaPagamento').textContent = `${installmentCount}x de ${formatCurrency(parcelaValor)} sem juros`;

            const sghNotice = document.getElementById('sghEssencialNotice');
            sghNotice.style.display = isSghEssencial ? 'block' : 'none';

            document.getElementById('proposalResult').style.display = 'block';

            return {
                establishment,
                bedRange,
                installmentCount,
                selectedModules,
                isSghEssencial,
                totals: {
                    monthly: totalMensal,
                    implantation: totalImplantacao,
                    total: totalGeral,
                    installmentValue: parcelaValor
                },
                date: new Date().toLocaleString('pt-BR')
            };
        }

        function makeEditable(event) {
            const cell = event.target;
            const currentValue = parseFloat(cell.textContent.replace(/[^\d,-]/g, '').replace(',', '.'));

            const input = document.createElement('input');
            input.type = 'number';
            input.step = '0.01';
            input.value = currentValue;
            input.style.width = '100%';
            input.style.padding = '8px';
            input.style.border = '2px solid #3498db';
            input.style.borderRadius = '4px';
            input.style.fontSize = '1rem';

            input.addEventListener('blur', function() {
                const newValue = parseFloat(this.value) || 0;
                cell.textContent = formatCurrency(newValue);
                this.remove();
                recalculateTotals();
            });

            input.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    input.blur();
                }
            });

            cell.textContent = '';
            cell.appendChild(input);
            input.focus();
            input.select();
        }

        function recalculateTotals() {
            let totalMensal = 0;
            let totalImplantacao = 0;

            document.querySelectorAll('#proposalTableBody tr').forEach(row => {
                const mensalCell = row.cells[1];
                const implantacaoCell = row.cells[2];

                if (mensalCell && implantacaoCell) {
                    const mensalValue = parseFloat(mensalCell.textContent.replace(/[^\d,-]/g, '').replace(',', '.')) || 0;
                    const implantacaoValue = parseFloat(implantacaoCell.textContent.replace(/[^\d,-]/g, '').replace(',', '.')) || 0;

                    totalMensal += mensalValue;
                    totalImplantacao += implantacaoValue;
                }
            });

            const installmentCount = parseInt(document.getElementById('installmentCount').value) || 1;
            const totalGeral = totalMensal + totalImplantacao;
            const parcelaValor = totalImplantacao / installmentCount;
            const parcelaTotal = parcelaValor * installmentCount;

            document.getElementById('totalMensal').textContent = formatCurrency(totalMensal);
            document.getElementById('totalImplantacao').textContent = formatCurrency(totalImplantacao);
            document.getElementById('totalGeral').textContent = formatCurrency(totalGeral);
            document.getElementById('parcelaValor').textContent = formatCurrency(parcelaValor);
            document.getElementById('parcelaTotal').textContent = formatCurrency(parcelaTotal);
            document.getElementById('formaPagamento').textContent = `${installmentCount}x de ${formatCurrency(parcelaValor)} sem juros`;
        }

        function saveCurrentProposal() {
            const proposalData = generateProposal();
            if (!proposalData) return;

            const proposalName = document.getElementById('proposalName').value || `Proposta ${new Date().toLocaleDateString()}`;
            proposalData.name = proposalName;

            let history = JSON.parse(localStorage.getItem('spdataProposalHistory') || '[]');
            history.unshift(proposalData);
            localStorage.setItem('spdataProposalHistory', JSON.stringify(history));

            alert(`✅ Proposta "${proposalName}" salva com sucesso!`);
            loadProposalHistory();
        }

        function loadProposalHistory() {
            const historyList = document.getElementById('historyList');
            const history = JSON.parse(localStorage.getItem('spdataProposalHistory') || '[]');

            if (history.length === 0) {
                historyList.innerHTML = '<p style="text-align: center; padding: 40px; color: #777;">Nenhuma proposta salva ainda.</p>';
                return;
            }

            historyList.innerHTML = '';

            history.forEach((proposal, index) => {
                const item = document.createElement('div');
                item.className = 'history-item';

                const date = new Date(proposal.date);
                const formattedDate = isNaN(date) ? proposal.date : date.toLocaleString('pt-BR');

                item.innerHTML = `
                    <div class="history-actions">
                        <button class="btn btn-primary" onclick="loadProposal(${index})">Carregar</button>
                        <button class="btn btn-print" onclick="printProposal(${index})">Imprimir</button>
                        <button class="btn btn-accent" onclick="deleteProposal(${index})">Excluir</button>
                    </div>
                    <h4>${proposal.name}</h4>
                    <p><strong>Data:</strong> ${formattedDate}</p>
                    <p><strong>Estabelecimento:</strong> ${proposal.establishment} - ${proposal.bedRange}</p>
                    <p><strong>Total Mensal:</strong> ${formatCurrency(proposal.totals.monthly)}</p>
                    <p><strong>Total Implantação:</strong> ${formatCurrency(proposal.totals.implantation)}</p>
                    <p><strong>Total Geral:</strong> ${formatCurrency(proposal.totals.total)}</p>
                    <p><strong>Módulos:</strong> ${proposal.selectedModules.map(m => m.name).join(', ')}</p>
                `;

                historyList.appendChild(item);
            });
        }

        function loadProposal(index) {
            const history = JSON.parse(localStorage.getItem('spdataProposalHistory') || '[]');
            const proposal = history[index];

            if (!proposal) return;

            document.getElementById('establishment').value = proposal.establishment;
            updateBedRangeOptions();
            setTimeout(() => {
                document.getElementById('bedRange').value = proposal.bedRange;
                document.getElementById('installmentCount').value = proposal.installmentCount;
                document.getElementById('proposalName').value = proposal.name;

                document.querySelectorAll('#modulesList input[type="checkbox"]').forEach(cb => {
                    cb.checked = false;
                    const configId = {
                        "Agendamento Online": "agendamentoConfig",
                        "CARTÃO DE DESCONTO": "cartaoConfig",
                        "SGO": "sgoConfig",
                        "SMS": "smsConfig"
                    }[cb.value];
                    if (configId) {
                        document.getElementById(configId).style.display = 'none';
                    }
                });

                if (proposal.isSghEssencial) {
                    document.querySelector('.proposal-type-btn[data-type="essencial"]').click();
                } else {
                    proposal.selectedModules.forEach(module => {
                        const checkboxId = `module_${module.name.replace(/[^a-zA-Z0-9]/g, '_')}`;
                        const checkbox = document.getElementById(checkboxId);
                        if (checkbox) {
                            checkbox.checked = true;

                            const configId = {
                                "Agendamento Online": "agendamentoConfig",
                                "CARTÃO DE DESCONTO": "cartaoConfig",
                                "SGO": "sgoConfig",
                                "SMS": "smsConfig"
                            }[module.name];

                            if (configId) {
                                document.getElementById(configId).style.display = 'block';
                            }
                        }
                    });
                }

                document.querySelector('[data-tab="proposal"]').click();
                generateProposal();

                alert(`✅ Proposta "${proposal.name}" carregada com sucesso!`);
            }, 100);
        }

        function deleteProposal(index) {
            if (!confirm("Tem certeza que deseja excluir esta proposta?")) return;

            let history = JSON.parse(localStorage.getItem('spdataProposalHistory') || '[]');
            history.splice(index, 1);
            localStorage.setItem('spdataProposalHistory', JSON.stringify(history));

            alert("✅ Proposta excluída com sucesso!");
            loadProposalHistory();
        }

        function printProposal(index) {
            loadProposal(index);
            setTimeout(() => {
                window.print();
            }, 500);
        }

        function exportToExcel() {
            const table = document.querySelector('.proposal-table');
            const wb = XLSX.utils.table_to_book(table, { sheet: "Proposta Spdata" });

            const ws = wb.Sheets[wb.SheetNames[0]];
            const lastRow = XLSX.utils.decode_range(ws['!ref']).e.r + 2;

            ws[`A${lastRow}`] = { v: "TOTAL MENSAL", t: 's' };
            ws[`B${lastRow}`] = { v: parseFloat(document.getElementById('totalMensal').textContent.replace(/[^\d,-]/g, '').replace(',', '.')), t: 'n' };
            ws[`B${lastRow}`].z = '#,##0.00';

            ws[`A${lastRow + 1}`] = { v: "TOTAL IMPLANTAÇÃO", t: 's' };
            ws[`B${lastRow + 1}`] = { v: parseFloat(document.getElementById('totalImplantacao').textContent.replace(/[^\d,-]/g, '').replace(',', '.')), t: 'n' };
            ws[`B${lastRow + 1}`].z = '#,##0.00';

            ws[`A${lastRow + 2}`] = { v: "TOTAL GERAL", t: 's' };
            ws[`B${lastRow + 2}`] = { v: parseFloat(document.getElementById('totalGeral').textContent.replace(/[^\d,-]/g, '').replace(',', '.')), t: 'n' };
            ws[`B${lastRow + 2}`].z = '#,##0.00';

            ws[`A${lastRow + 4}`] = { v: "PARCELAS", t: 's' };
            ws[`B${lastRow + 4}`] = { v: document.getElementById('formaPagamento').textContent, t: 's' };

            ws[`A${lastRow + 5}`] = { v: "VALIDADE", t: 's' };
            ws[`B${lastRow + 5}`] = { v: "30 dias", t: 's' };

            const colWidths = [
                { wch: 40 },
                { wch: 20 },
                { wch: 20 }
            ];
            ws['!cols'] = colWidths;

            XLSX.writeFile(wb, 'proposta_spdata.xlsx');
        }
    </script>
</body>
</html>
